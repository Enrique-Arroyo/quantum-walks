(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Wolfram 14.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       154,          7]
NotebookDataLength[    127478,       2515]
NotebookOptionsPosition[    124661,       2462]
NotebookOutlinePosition[    125104,       2479]
CellTagsIndexPosition[    125061,       2476]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Quantum Walks", "Title",
 CellFrame->{{0, 0}, {0, 0}},
 CellChangeTimes->{{3.474875286234375*^9, 3.4748752893125*^9}, {
   3.8410518881978817`*^9, 3.841051892894799*^9}, {3.9358155252671337`*^9, 
   3.935815537718157*^9}, {3.936273969036667*^9, 3.9362739691216106`*^9}, 
   3.9371135952916317`*^9, 
   3.9377185456360435`*^9},ExpressionUUID->"5a38b9c0-faae-a047-80bf-\
5335cb5116f1"],

Cell[TextData[StyleBox["Author: Enrique Arroyo Moro. MIT License (see \
LICENSE). Citation: see CITATION.cff.",
 FontSize->16,
 FontColor->RGBColor[
  0.5019607843137255, 0.5019607843137255, 0.5019607843137255]]], "Author",
 CellChangeTimes->{{3.474875286234375*^9, 3.4748752893125*^9}, {
   3.8410518881978817`*^9, 3.841051892894799*^9}, {3.9358155252671337`*^9, 
   3.9358155584315033`*^9}, {3.937718520364422*^9, 3.937718539687895*^9}, {
   3.9377186783377285`*^9, 3.9377186836988087`*^9}, {3.9377190947381096`*^9, 
   3.9377191255897408`*^9}, {3.937970246887789*^9, 3.9379702883274765`*^9}, {
   3.9379779862304707`*^9, 3.9379779877920227`*^9}, {3.9788595221664467`*^9, 
   3.9788595346885777`*^9}, {3.9788599887022533`*^9, 3.978860019969227*^9}, 
   3.978860074224327*^9, {3.978860152382641*^9, 3.978860181310684*^9}, {
   3.9788602808241024`*^9, 3.978860311877512*^9}},
 TextJustification->1.,ExpressionUUID->"5857c629-264d-b14c-82cf-e2477be330fe"],

Cell[CellGroupData[{

Cell["\<\
Simulation 1: Probability distribution for 1D quantum walk at 100 steps\
\>", "Chapter",
 CellChangeTimes->{{3.937718652475172*^9, 3.93771866424946*^9}, {
  3.937718774455246*^9, 3.937718826330305*^9}, {3.937720978119156*^9, 
  3.9377209794609623`*^9}},ExpressionUUID->"a54fa6ab-5893-c543-84d5-\
b479b6ee5c11"],

Cell[TextData[{
 "We plot the position probability distribution of a 1D discrete-time quantum \
walk [1]. The walker has spin ",
 Cell[BoxData[
  FormBox[
   RowBox[{"s", "=", 
    RowBox[{"1", "/", "2"}]}], TraditionalForm]],ExpressionUUID->
  "b939eef7-6f36-a947-a179-b4a0019c4d1b"],
 ", so the coin space is two-dimensional, with basis states",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"|", "0"}], "\[RightAngleBracket]"}], TraditionalForm]],
  ExpressionUUID->"09f044d3-2b32-564b-9d12-2a51f36dbb3b"],
 "  (spin up) and ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"|", "1"}], "\[RightAngleBracket]"}], TraditionalForm]],
  ExpressionUUID->"3c1ed583-2218-7142-9b48-1ae290b253d5"],
 " (spin down). The walk takes place on a 1D lattice with  ",
 Cell[BoxData[
  FormBox[
   RowBox[{"n", "=", "201"}], TraditionalForm]],ExpressionUUID->
  "2d5a4725-1132-934c-8c03-04bbe468ae9d"],
 " sites, and we evolve the system for 100 steps. The initial state is chosen \
as ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"|", "0"}], "\[RightAngleBracket]"}], TraditionalForm]],
  ExpressionUUID->"b574c27f-7010-db48-aa78-3c6aada04409"],
 "  in the coin (spin) space and ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"|", "0"}], "\[RightAngleBracket]"}], TraditionalForm]],
  ExpressionUUID->"0e8471dd-22e9-584e-bebd-90b86e63a0e2"],
 "  in position space, i.e., the walker is fully localized at position ",
 Cell[BoxData[
  FormBox[
   RowBox[{"x", "=", "0"}], TraditionalForm]],ExpressionUUID->
  "264e90d5-0fe1-5b45-bee6-0e9ad4933061"],
 " . Both the number of lattice sites ",
 Cell[BoxData[
  FormBox["n", TraditionalForm]],ExpressionUUID->
  "be8c0279-b3da-5043-84ff-76ba35013d09"],
 " and the number of steps can be easily modified at the beginning of the \
code."
}], "Text",
 CellFrame->{{0, 0}, {0, 0}},
 CellChangeTimes->{{3.9371210554203663`*^9, 3.9371211223537273`*^9}, 
   3.9371212158161144`*^9, 3.9376283187763042`*^9, {3.9376283503186684`*^9, 
   3.937628463043869*^9}, {3.937628589862278*^9, 3.9376287170224648`*^9}, {
   3.9376289750151863`*^9, 3.9376290110332985`*^9}, {3.937629046627548*^9, 
   3.9376292220868435`*^9}, {3.9376292952296486`*^9, 
   3.9376293099044895`*^9}, {3.937629394158041*^9, 3.9376295119787464`*^9}, {
   3.9376297487521687`*^9, 3.937629837919245*^9}, {3.937629912247637*^9, 
   3.937629972841196*^9}, {3.937630088268343*^9, 3.937630117295601*^9}, {
   3.937630162335182*^9, 3.9376303648756294`*^9}, {3.937630425324274*^9, 
   3.937630447904564*^9}, {3.9376310981933765`*^9, 3.9376311356078644`*^9}, {
   3.937631202183607*^9, 3.937631259009451*^9}, {3.937631291364292*^9, 
   3.9376313135821934`*^9}, {3.937631348683321*^9, 3.9376313692178726`*^9}, {
   3.937631407608553*^9, 3.9376314127031097`*^9}, {3.9376315134897423`*^9, 
   3.937631578392145*^9}, {3.9376316101098385`*^9, 3.937631655282322*^9}, {
   3.937631703194359*^9, 3.9376317365512066`*^9}, {3.9376318463940296`*^9, 
   3.9376318473597317`*^9}, {3.9376326194713974`*^9, 3.9376326628643*^9}, {
   3.937632742923023*^9, 3.9376328437132893`*^9}, {3.9376329233939114`*^9, 
   3.9376329994053288`*^9}, {3.9376330342424107`*^9, 3.937633060236559*^9}, {
   3.9376342046593895`*^9, 3.937634208012888*^9}, {3.937634243899828*^9, 
   3.93763424655826*^9}, {3.9376359788286457`*^9, 3.937635987173435*^9}, {
   3.9376360353926105`*^9, 3.937636122034252*^9}, {3.937636162859995*^9, 
   3.9376361796847973`*^9}, {3.9376362319433765`*^9, 
   3.9376362351220837`*^9}, {3.937636347463188*^9, 3.9376363519557877`*^9}, {
   3.9376366316827545`*^9, 3.937636748521101*^9}, {3.937636831723427*^9, 
   3.93763688677104*^9}, {3.937637031545891*^9, 3.9376370780055866`*^9}, {
   3.937637113929199*^9, 3.937637220422846*^9}, {3.9376372551130886`*^9, 
   3.937637308244028*^9}, {3.9376373476573467`*^9, 3.937637406535515*^9}, {
   3.9376374558463383`*^9, 3.937637547589367*^9}, {3.9376375784290524`*^9, 
   3.9376376458414993`*^9}, {3.9376376926816807`*^9, 
   3.9376377427232285`*^9}, {3.937637815269718*^9, 3.937638006644993*^9}, 
   3.937638131539238*^9, {3.9376382526047764`*^9, 3.9376383778615856`*^9}, {
   3.937638427631836*^9, 3.9376384457953606`*^9}, {3.9376384991287155`*^9, 
   3.937638556890009*^9}, {3.9376386785612183`*^9, 3.9376386807061844`*^9}, 
   3.937638718801607*^9, {3.937638756456089*^9, 3.937638805246828*^9}, {
   3.937639135678833*^9, 3.937639146248209*^9}, {3.9376392044773464`*^9, 
   3.9376392183913345`*^9}, {3.937639265823965*^9, 3.937639268936657*^9}, {
   3.937639307574539*^9, 3.937639383049654*^9}, 3.9376396634813385`*^9, {
   3.937640275495823*^9, 3.9376402800294647`*^9}, {3.937640481635622*^9, 
   3.9376404878876286`*^9}, {3.9376405201948166`*^9, 3.937640579828453*^9}, {
   3.9376406740112686`*^9, 3.937640697118286*^9}, {3.9376411569801083`*^9, 
   3.937641168825096*^9}, {3.9376412862195263`*^9, 3.937641376228302*^9}, 
   3.9376416844560757`*^9, 3.937641725270973*^9, {3.9376418272762775`*^9, 
   3.937641838503166*^9}, {3.937642051754429*^9, 3.9376420983479176`*^9}, 
   3.9376461052260036`*^9, {3.937649464136503*^9, 3.937649655653105*^9}, {
   3.9376496918131638`*^9, 3.937649903471182*^9}, {3.937649988547306*^9, 
   3.937650195922489*^9}, {3.9376502687999115`*^9, 3.9376503394171677`*^9}, {
   3.9376503914331665`*^9, 3.9376504244380608`*^9}, {3.9376504545612965`*^9, 
   3.9376505026856194`*^9}, {3.9376505511455326`*^9, 3.937650723070215*^9}, {
   3.9376508550984707`*^9, 3.937650863163862*^9}, {3.9376509203334656`*^9, 
   3.937650945087673*^9}, {3.93765104551042*^9, 3.9376511829815216`*^9}, {
   3.937651427126198*^9, 3.9376515772553864`*^9}, {3.9376516270518246`*^9, 
   3.9376516462229214`*^9}, 3.937651708853506*^9, {3.937651933314291*^9, 
   3.9376519973766823`*^9}, {3.9376520386997585`*^9, 3.937652078166788*^9}, {
   3.9376521149482765`*^9, 3.9376521737930584`*^9}, {3.937652247555382*^9, 
   3.937652272011904*^9}, {3.937652573305933*^9, 3.937652651598303*^9}, {
   3.937652710705511*^9, 3.937652719594286*^9}, {3.937652751537121*^9, 
   3.937652889792959*^9}, {3.937653424964319*^9, 3.937653440387474*^9}, {
   3.937653486630764*^9, 3.9376535219991455`*^9}, {3.9376537667703705`*^9, 
   3.9376537712246876`*^9}, {3.9376540126467857`*^9, 3.937654060140789*^9}, {
   3.937654127664316*^9, 3.937654209058943*^9}, {3.937654325815996*^9, 
   3.937654343851843*^9}, {3.937654431782078*^9, 3.9376544320266876`*^9}, {
   3.9376544649461403`*^9, 3.9376548808085117`*^9}, {3.9376549252184067`*^9, 
   3.9376549707353115`*^9}, {3.9376550093697586`*^9, 3.9376550287134*^9}, {
   3.937655240866829*^9, 3.9376552837707577`*^9}, {3.937655350320101*^9, 
   3.9376554619829845`*^9}, {3.9376555463594112`*^9, 3.93765557166185*^9}, {
   3.9376557816231804`*^9, 3.9376558587066593`*^9}, {3.9376559031095695`*^9, 
   3.937656009151085*^9}, {3.937656040345949*^9, 3.9376560744786167`*^9}, {
   3.937656108794525*^9, 3.937656303086073*^9}, {3.9376563545804825`*^9, 
   3.9376563910538673`*^9}, {3.937656438858263*^9, 3.93765648134387*^9}, {
   3.937656512473156*^9, 3.9376565660443363`*^9}, {3.937656680393984*^9, 
   3.9376567840551167`*^9}, {3.9376569111185017`*^9, 3.937656938609873*^9}, {
   3.9376569970376835`*^9, 3.9376570957105865`*^9}, {3.937657190793457*^9, 
   3.93765727117675*^9}, {3.937657340583193*^9, 3.9376573611231537`*^9}, {
   3.9376573951299953`*^9, 3.9376574529761486`*^9}, {3.9376574879749317`*^9, 
   3.937657506795227*^9}, {3.937657685805044*^9, 3.937657710149948*^9}, {
   3.937658879765518*^9, 3.937658960186018*^9}, {3.9376589973941193`*^9, 
   3.937659112643835*^9}, {3.937659154887083*^9, 3.937659228953888*^9}, {
   3.937659260009138*^9, 3.9376592611927414`*^9}, {3.937659315329296*^9, 
   3.937659371712679*^9}, {3.937659509775406*^9, 3.937659510423092*^9}, {
   3.937659553141968*^9, 3.9376595751577244`*^9}, {3.937659634766691*^9, 
   3.937659640409479*^9}, {3.9376596827090855`*^9, 3.937659722403181*^9}, {
   3.937659804559059*^9, 3.9376599282209816`*^9}, {3.9376599595802937`*^9, 
   3.9376600125880604`*^9}, {3.937660071283558*^9, 3.9376600766696644`*^9}, {
   3.9376601368856316`*^9, 3.9376601776762867`*^9}, {3.9376602339770985`*^9, 
   3.9376602439550343`*^9}, {3.93766047757798*^9, 3.937660483298315*^9}, {
   3.9376665349950047`*^9, 3.937666536944111*^9}, {3.937666568767618*^9, 
   3.937666604213175*^9}, {3.937666933178961*^9, 3.9376669333647804`*^9}, {
   3.937667081846863*^9, 3.937667082583967*^9}, {3.937673085853033*^9, 
   3.9376730891173477`*^9}, {3.937718200492319*^9, 3.937718398019949*^9}, {
   3.9377186411000824`*^9, 3.9377186471098824`*^9}, {3.9377186978806477`*^9, 
   3.9377187293472157`*^9}, {3.9377191620834103`*^9, 3.937719164194559*^9}, {
   3.9377203202173824`*^9, 3.9377205589359646`*^9}, {3.9377218803011703`*^9, 
   3.9377218865452423`*^9}, {3.9377224756775494`*^9, 3.937722521158188*^9}, 
   3.937823216939539*^9, {3.978863054879772*^9, 3.978863055116081*^9}, 
   3.978863467969961*^9, {3.9788643710525665`*^9, 3.978864371643673*^9}},
 Background->RGBColor[
  0.88, 1, 0.88],ExpressionUUID->"4a15a03f-6504-b642-a1a1-b0fb29c25f50"],

Cell[TextData[{
 "We use the Hadamard operator as the coin, yielding the standard Hadamard \
walk. The conditional shift is defined as follows: if the spin is ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"|", "0"}], "\[RightAngleBracket]"}], TraditionalForm]],
  ExpressionUUID->"ac8f6fcd-4c2f-534c-a37a-3afbf4201df4"],
 " , the walker moves one site to the left; if the spin is ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"|", "1"}], "\[RightAngleBracket]"}], TraditionalForm]],
  ExpressionUUID->"ecadee44-42c4-124b-bc48-9bd55376aeec"],
 ", it moves one site to the right. Instead of explicitly constructing the \
full shift operator (which would be a ",
 Cell[BoxData[
  FormBox[
   RowBox[{"2", "n", " ", "x", " ", "2", "n"}], TraditionalForm]],
  ExpressionUUID->"68c0e87d-c691-1841-aba4-a88c72e75925"],
 " matrix), we implement the shift by directly re-indexing (rotating) the \
components of the wavefunction. This produces the same result while being \
computationally more efficient."
}], "Text",
 CellFrame->{{0, 0}, {0, 0}},
 CellChangeTimes->{{3.9371210554203663`*^9, 3.9371211223537273`*^9}, 
   3.9371212158161144`*^9, 3.9376283187763042`*^9, {3.9376283503186684`*^9, 
   3.937628463043869*^9}, {3.937628589862278*^9, 3.9376287170224648`*^9}, {
   3.9376289750151863`*^9, 3.9376290110332985`*^9}, {3.937629046627548*^9, 
   3.9376292220868435`*^9}, {3.9376292952296486`*^9, 
   3.9376293099044895`*^9}, {3.937629394158041*^9, 3.9376295119787464`*^9}, {
   3.9376297487521687`*^9, 3.937629837919245*^9}, {3.937629912247637*^9, 
   3.937629972841196*^9}, {3.937630088268343*^9, 3.937630117295601*^9}, {
   3.937630162335182*^9, 3.9376303648756294`*^9}, {3.937630425324274*^9, 
   3.937630447904564*^9}, {3.9376310981933765`*^9, 3.9376311356078644`*^9}, {
   3.937631202183607*^9, 3.937631259009451*^9}, {3.937631291364292*^9, 
   3.9376313135821934`*^9}, {3.937631348683321*^9, 3.9376313692178726`*^9}, {
   3.937631407608553*^9, 3.9376314127031097`*^9}, {3.9376315134897423`*^9, 
   3.937631578392145*^9}, {3.9376316101098385`*^9, 3.937631655282322*^9}, {
   3.937631703194359*^9, 3.9376317365512066`*^9}, {3.9376318463940296`*^9, 
   3.9376318473597317`*^9}, {3.9376326194713974`*^9, 3.9376326628643*^9}, {
   3.937632742923023*^9, 3.9376328437132893`*^9}, {3.9376329233939114`*^9, 
   3.9376329994053288`*^9}, {3.9376330342424107`*^9, 3.937633060236559*^9}, {
   3.9376342046593895`*^9, 3.937634208012888*^9}, {3.937634243899828*^9, 
   3.93763424655826*^9}, {3.9376359788286457`*^9, 3.937635987173435*^9}, {
   3.9376360353926105`*^9, 3.937636122034252*^9}, {3.937636162859995*^9, 
   3.9376361796847973`*^9}, {3.9376362319433765`*^9, 
   3.9376362351220837`*^9}, {3.937636347463188*^9, 3.9376363519557877`*^9}, {
   3.9376366316827545`*^9, 3.937636748521101*^9}, {3.937636831723427*^9, 
   3.93763688677104*^9}, {3.937637031545891*^9, 3.9376370780055866`*^9}, {
   3.937637113929199*^9, 3.937637220422846*^9}, {3.9376372551130886`*^9, 
   3.937637308244028*^9}, {3.9376373476573467`*^9, 3.937637406535515*^9}, {
   3.9376374558463383`*^9, 3.937637547589367*^9}, {3.9376375784290524`*^9, 
   3.9376376458414993`*^9}, {3.9376376926816807`*^9, 
   3.9376377427232285`*^9}, {3.937637815269718*^9, 3.937638006644993*^9}, 
   3.937638131539238*^9, {3.9376382526047764`*^9, 3.9376383778615856`*^9}, {
   3.937638427631836*^9, 3.9376384457953606`*^9}, {3.9376384991287155`*^9, 
   3.937638556890009*^9}, {3.9376386785612183`*^9, 3.9376386807061844`*^9}, 
   3.937638718801607*^9, {3.937638756456089*^9, 3.937638805246828*^9}, {
   3.937639135678833*^9, 3.937639146248209*^9}, {3.9376392044773464`*^9, 
   3.9376392183913345`*^9}, {3.937639265823965*^9, 3.937639268936657*^9}, {
   3.937639307574539*^9, 3.937639383049654*^9}, 3.9376396634813385`*^9, {
   3.937640275495823*^9, 3.9376402800294647`*^9}, {3.937640481635622*^9, 
   3.9376404878876286`*^9}, {3.9376405201948166`*^9, 3.937640579828453*^9}, {
   3.9376406740112686`*^9, 3.937640697118286*^9}, {3.9376411569801083`*^9, 
   3.937641168825096*^9}, {3.9376412862195263`*^9, 3.937641376228302*^9}, 
   3.9376416844560757`*^9, 3.937641725270973*^9, {3.9376418272762775`*^9, 
   3.937641838503166*^9}, {3.937642051754429*^9, 3.9376420983479176`*^9}, 
   3.9376461052260036`*^9, {3.937649464136503*^9, 3.937649655653105*^9}, {
   3.9376496918131638`*^9, 3.937649903471182*^9}, {3.937649988547306*^9, 
   3.937650195922489*^9}, {3.9376502687999115`*^9, 3.9376503394171677`*^9}, {
   3.9376503914331665`*^9, 3.9376504244380608`*^9}, {3.9376504545612965`*^9, 
   3.9376505026856194`*^9}, {3.9376505511455326`*^9, 3.937650723070215*^9}, {
   3.9376508550984707`*^9, 3.937650863163862*^9}, {3.9376509203334656`*^9, 
   3.937650945087673*^9}, {3.93765104551042*^9, 3.9376511829815216`*^9}, {
   3.937651427126198*^9, 3.9376515772553864`*^9}, {3.9376516270518246`*^9, 
   3.9376516462229214`*^9}, 3.937651708853506*^9, {3.937651933314291*^9, 
   3.9376519973766823`*^9}, {3.9376520386997585`*^9, 3.937652078166788*^9}, {
   3.9376521149482765`*^9, 3.9376521737930584`*^9}, {3.937652247555382*^9, 
   3.937652272011904*^9}, {3.937652573305933*^9, 3.937652651598303*^9}, {
   3.937652710705511*^9, 3.937652719594286*^9}, {3.937652751537121*^9, 
   3.937652889792959*^9}, {3.937653424964319*^9, 3.937653440387474*^9}, {
   3.937653486630764*^9, 3.9376535219991455`*^9}, {3.9376537667703705`*^9, 
   3.9376537712246876`*^9}, {3.9376540126467857`*^9, 3.937654060140789*^9}, {
   3.937654127664316*^9, 3.937654209058943*^9}, {3.937654325815996*^9, 
   3.937654343851843*^9}, {3.937654431782078*^9, 3.9376544320266876`*^9}, {
   3.9376544649461403`*^9, 3.9376548808085117`*^9}, {3.9376549252184067`*^9, 
   3.9376549707353115`*^9}, {3.9376550093697586`*^9, 3.9376550287134*^9}, {
   3.937655240866829*^9, 3.9376552837707577`*^9}, {3.937655350320101*^9, 
   3.9376554619829845`*^9}, {3.9376555463594112`*^9, 3.93765557166185*^9}, {
   3.9376557816231804`*^9, 3.9376558587066593`*^9}, {3.9376559031095695`*^9, 
   3.937656009151085*^9}, {3.937656040345949*^9, 3.9376560744786167`*^9}, {
   3.937656108794525*^9, 3.937656303086073*^9}, {3.9376563545804825`*^9, 
   3.9376563910538673`*^9}, {3.937656438858263*^9, 3.93765648134387*^9}, {
   3.937656512473156*^9, 3.9376565660443363`*^9}, {3.937656680393984*^9, 
   3.9376567840551167`*^9}, {3.9376569111185017`*^9, 3.937656938609873*^9}, {
   3.9376569970376835`*^9, 3.9376570957105865`*^9}, {3.937657190793457*^9, 
   3.93765727117675*^9}, {3.937657340583193*^9, 3.9376573611231537`*^9}, {
   3.9376573951299953`*^9, 3.9376574529761486`*^9}, {3.9376574879749317`*^9, 
   3.937657506795227*^9}, {3.937657685805044*^9, 3.937657710149948*^9}, {
   3.937658879765518*^9, 3.937658960186018*^9}, {3.9376589973941193`*^9, 
   3.937659112643835*^9}, {3.937659154887083*^9, 3.937659228953888*^9}, {
   3.937659260009138*^9, 3.9376592611927414`*^9}, {3.937659315329296*^9, 
   3.937659371712679*^9}, {3.937659509775406*^9, 3.937659510423092*^9}, {
   3.937659553141968*^9, 3.9376595751577244`*^9}, {3.937659634766691*^9, 
   3.937659640409479*^9}, {3.9376596827090855`*^9, 3.937659722403181*^9}, {
   3.937659804559059*^9, 3.9376599282209816`*^9}, {3.9376599595802937`*^9, 
   3.9376600125880604`*^9}, {3.937660071283558*^9, 3.9376600766696644`*^9}, {
   3.9376601368856316`*^9, 3.9376601776762867`*^9}, {3.9376602339770985`*^9, 
   3.9376602439550343`*^9}, {3.93766047757798*^9, 3.937660483298315*^9}, {
   3.9376665349950047`*^9, 3.937666536944111*^9}, {3.937666568767618*^9, 
   3.937666604213175*^9}, {3.937666933178961*^9, 3.9376669333647804`*^9}, {
   3.937667081846863*^9, 3.937667082583967*^9}, {3.937673085853033*^9, 
   3.9376730891173477`*^9}, {3.937718200492319*^9, 3.937718398019949*^9}, {
   3.9377186411000824`*^9, 3.9377186471098824`*^9}, {3.9377186978806477`*^9, 
   3.9377187293472157`*^9}, {3.9377191620834103`*^9, 3.937719164194559*^9}, {
   3.9377203202173824`*^9, 3.9377205589359646`*^9}, {3.9377218803011703`*^9, 
   3.9377218865452423`*^9}, {3.9377224756775494`*^9, 3.937722521158188*^9}, {
   3.93782321824984*^9, 3.937823276716097*^9}, {3.9378233499188423`*^9, 
   3.937823370442669*^9}, {3.9788604766534443`*^9, 3.9788604785217304`*^9}, 
   3.9788634727369957`*^9, {3.9788643976935577`*^9, 3.9788644126516895`*^9}, {
   3.978864787517336*^9, 3.9788647898048744`*^9}},
 Background->RGBColor[
  0.88, 1, 0.88],ExpressionUUID->"9726387c-074d-d74c-acf8-8d936d550550"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"s", "=", 
    RowBox[{"1", "/", "2"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{"spin", " ", "of", " ", "the", " ", "walker"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"n", "=", "201"}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
   "number", " ", "of", " ", "allowed", " ", "positions", " ", "for", " ", 
    "the", " ", "walked"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"steps", "=", "100"}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{"maximum", " ", "steps", " ", "the", " ", "walker", " ", "takes"}],
    "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"spinini", "=", 
    RowBox[{"SparseArray", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", "1", "}"}], "->", "1"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"2", "s"}], "+", "1"}], "}"}]}], "]"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "initial", " ", "conditions", " ", "for", " ", "the", " ", "spin"}], ",", 
    " ", 
    RowBox[{
     RowBox[{
     "note", " ", "that", " ", "the", " ", "element", " ", "1", " ", "refers",
       " ", "to"}], " ", "|", 
     RowBox[{"0", ">", " ", 
      RowBox[{"(", 
       RowBox[{"spin", " ", "up"}], ")"}]}]}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"positionini", "=", 
    RowBox[{"SparseArray", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", "101", "}"}], "->", "1"}], ",", 
      RowBox[{"{", "n", "}"}]}], "]"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
   "initial", " ", "conditions", " ", "for", " ", "the", " ", "position"}], 
   "*)"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"wavefunction", "=", 
    RowBox[{"Flatten", "[", 
     RowBox[{"KroneckerProduct", "[", 
      RowBox[{"spinini", ",", "positionini"}], "]"}], "]"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
   "the", " ", "initial", " ", "conditions", " ", "define", " ", "the", " ", 
    "initial", " ", "wavefunction"}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"H", "=", 
    RowBox[{"KroneckerProduct", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"1", "/", 
        SqrtBox["2"]}], 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", 
           RowBox[{"-", "1"}]}], "}"}]}], "}"}]}], ",", 
      RowBox[{"IdentityMatrix", "[", "n", "]"}]}], "]"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
   "our", " ", "coin", " ", "operator", " ", "is", " ", "the", " ", 
    "Hadamard", " ", "transform"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"shift", "[", "wavefunction_", "]"}], ":=", 
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"RotateLeft", "[", 
       RowBox[{"wavefunction", "[", 
        RowBox[{"[", 
         RowBox[{"1", ";;", "n"}], "]"}], "]"}], "]"}], ",", 
      RowBox[{"RotateRight", "[", 
       RowBox[{"wavefunction", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"n", "+", "1"}], ";;", 
          RowBox[{"2", "n"}]}], "]"}], "]"}], " ", "]"}]}], "]"}]}], ";"}], 
  " ", 
  RowBox[{"(*", 
   RowBox[{"shift", " ", "operation", " ", "encoded"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"coinandshift", "[", "wavefunction_", "]"}], ":=", 
    RowBox[{"shift", "[", 
     RowBox[{"H", ".", "wavefunction"}], "]"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
   "a", " ", "combination", " ", "of", " ", "applying", " ", "the", " ", 
    "coin", " ", "operator", " ", "and", " ", "then", " ", "the", " ", 
    "shift"}], "*)"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"wavefunction", "=", 
    RowBox[{"Nest", "[", 
     RowBox[{"coinandshift", ",", "wavefunction", ",", "steps"}], "]"}]}], 
   ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
   "coin", " ", "and", " ", "shift", " ", "are", " ", "applied", " ", "a", 
    " ", "number", " ", "of", " ", "times", " ", "to", " ", "the", " ", 
    "wavefunction", " ", "defined", " ", "by", " ", "the", " ", "steps"}], 
   "*)"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"probability", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"Abs", "[", 
       RowBox[{"wavefunction", "[", 
        RowBox[{"[", 
         RowBox[{"1", ";;", "n"}], "]"}], "]"}], "]"}], "^", "2"}], "+", 
     RowBox[{
      RowBox[{"Abs", "[", 
       RowBox[{"wavefunction", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"n", "+", "1"}], ";;", 
          RowBox[{"2", "n"}]}], "]"}], "]"}], "]"}], "^", "2"}]}]}], ";"}], 
  " ", 
  RowBox[{"(*", 
   RowBox[{
   "the", " ", "probability", " ", "is", " ", "computed", " ", "as", " ", 
    "the", " ", "sum", " ", "of", " ", "the", " ", "components", " ", 
    "squared"}], "*)"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"ListPlot", "[", 
  RowBox[{"probability", ",", 
   RowBox[{"DataRange", "->", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "100"}], ",", "100"}], "}"}]}], ",", 
   RowBox[{"PlotRange", "->", "Full"}], ",", 
   RowBox[{"Joined", "->", "True"}], ",", 
   RowBox[{"GridLines", "->", "Automatic"}], ",", 
   RowBox[{
   "PlotLabel", "->", 
    "\"\<Probability distribution for 1D quantum walk at 100 steps\>\""}], 
   ",", 
   RowBox[{"Frame", "->", "True"}], ",", 
   RowBox[{"FrameLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<Position\>\"", ",", "\"\<Probability\>\""}], "}"}]}], ",", 
   RowBox[{"ImageSize", "->", "500"}]}], 
  "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.937666823943924*^9, 3.9376668254592896`*^9}, {
   3.9376670851524563`*^9, 3.937667089619383*^9}, {3.9376671812284546`*^9, 
   3.9376671850631733`*^9}, {3.9376675833417435`*^9, 3.937667583995796*^9}, {
   3.937667626190607*^9, 3.9376676370822544`*^9}, 3.9376676811993694`*^9, {
   3.9376679096460857`*^9, 3.937667965118927*^9}, {3.937668011060465*^9, 
   3.9376680183342495`*^9}, {3.9376681313554535`*^9, 3.937668386660206*^9}, {
   3.937668472267082*^9, 3.937668512412895*^9}, {3.9376690261974525`*^9, 
   3.9376690513977184`*^9}, {3.9376692881848392`*^9, 3.93766935975782*^9}, 
   3.9376698230325165`*^9, {3.9376698831949654`*^9, 3.937669985965637*^9}, {
   3.937670056475773*^9, 3.9376701713947887`*^9}, {3.937670208175968*^9, 
   3.937670406196396*^9}, {3.937670458125099*^9, 3.937670465165104*^9}, {
   3.9376705043243427`*^9, 3.9376706151955776`*^9}, {3.9376706474210835`*^9, 
   3.9376706774346695`*^9}, {3.9376707165701942`*^9, 3.937670749859289*^9}, {
   3.937671197773144*^9, 3.9376712028524*^9}, {3.93767136767766*^9, 
   3.9376713734478397`*^9}, {3.937671420088827*^9, 3.9376714378177013`*^9}, {
   3.9376714743956223`*^9, 3.937671685337303*^9}, {3.9376717314565334`*^9, 
   3.937671822035677*^9}, {3.9376718560842113`*^9, 3.937671924176157*^9}, {
   3.9376719625708656`*^9, 3.93767197013743*^9}, {3.9376720933578796`*^9, 
   3.937672332744671*^9}, {3.937672380595249*^9, 3.93767239316996*^9}, {
   3.937672436129175*^9, 3.9376724751047516`*^9}, {3.937672623650461*^9, 
   3.9376726238224564`*^9}, {3.937672814169367*^9, 3.937672884330427*^9}, {
   3.937672940677597*^9, 3.9376729812583923`*^9}, {3.9376730984715557`*^9, 
   3.9376733323446693`*^9}, {3.937718837708889*^9, 3.937718837881504*^9}, 
   3.9377219017229824`*^9, {3.937722070397312*^9, 3.937722081070692*^9}, {
   3.9377223518857517`*^9, 3.9377223866092644`*^9}, {3.9377224281107044`*^9, 
   3.9377224319520073`*^9}, {3.9377225475603905`*^9, 3.9377225533700905`*^9}, 
   3.937728254066662*^9, {3.937823295140236*^9, 3.937823311123152*^9}, {
   3.9378233430110855`*^9, 3.937823343615299*^9}, {3.9379650289703484`*^9, 
   3.9379650361966057`*^9}, {3.937966774784733*^9, 3.937966785659212*^9}, 
   3.978860743465084*^9, {3.978862174977127*^9, 3.9788621778408527`*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"bd7fc86f-edc4-9043-8139-c0c4012eafbb"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Simulation 2: Animated probability distribution for 1D quantum walk\
\>", "Chapter",
 CellChangeTimes->{{3.937718652475172*^9, 3.93771866424946*^9}, 
   3.937718758111515*^9, 3.937718793419386*^9, {3.9377188428774986`*^9, 
   3.9377188589349155`*^9}, {3.937720988493572*^9, 
   3.937720989781889*^9}},ExpressionUUID->"a22ffb84-6732-ee41-a9b0-\
6469943adb58"],

Cell[TextData[{
 "With a small modification to the code, we animate the position probability \
distribution over several time steps [1]. We consider the same spin-1/2 \
walker (two spin states) on a 1D lattice with ",
 Cell[BoxData[
  FormBox[
   RowBox[{"n", "=", "201", " "}], TraditionalForm]],ExpressionUUID->
  "d7ba1749-1388-5146-bd3f-1d4e33367971"],
 " sites, using the same coin, shift rule, and initial state as in Simulation \
1."
}], "Text",
 CellFrame->{{0, 0}, {0, 0}},
 InitializationCell->True,
 CellChangeTimes->{{3.9371210554203663`*^9, 3.9371211223537273`*^9}, 
   3.9371212158161144`*^9, 3.9376283187763042`*^9, {3.9376283503186684`*^9, 
   3.937628463043869*^9}, {3.937628589862278*^9, 3.9376287170224648`*^9}, {
   3.9376289750151863`*^9, 3.9376290110332985`*^9}, {3.937629046627548*^9, 
   3.9376292220868435`*^9}, {3.9376292952296486`*^9, 
   3.9376293099044895`*^9}, {3.937629394158041*^9, 3.9376295119787464`*^9}, {
   3.9376297487521687`*^9, 3.937629837919245*^9}, {3.937629912247637*^9, 
   3.937629972841196*^9}, {3.937630088268343*^9, 3.937630117295601*^9}, {
   3.937630162335182*^9, 3.9376303648756294`*^9}, {3.937630425324274*^9, 
   3.937630447904564*^9}, {3.9376310981933765`*^9, 3.9376311356078644`*^9}, {
   3.937631202183607*^9, 3.937631259009451*^9}, {3.937631291364292*^9, 
   3.9376313135821934`*^9}, {3.937631348683321*^9, 3.9376313692178726`*^9}, {
   3.937631407608553*^9, 3.9376314127031097`*^9}, {3.9376315134897423`*^9, 
   3.937631578392145*^9}, {3.9376316101098385`*^9, 3.937631655282322*^9}, {
   3.937631703194359*^9, 3.9376317365512066`*^9}, {3.9376318463940296`*^9, 
   3.9376318473597317`*^9}, {3.9376326194713974`*^9, 3.9376326628643*^9}, {
   3.937632742923023*^9, 3.9376328437132893`*^9}, {3.9376329233939114`*^9, 
   3.9376329994053288`*^9}, {3.9376330342424107`*^9, 3.937633060236559*^9}, {
   3.9376342046593895`*^9, 3.937634208012888*^9}, {3.937634243899828*^9, 
   3.93763424655826*^9}, {3.9376359788286457`*^9, 3.937635987173435*^9}, {
   3.9376360353926105`*^9, 3.937636122034252*^9}, {3.937636162859995*^9, 
   3.9376361796847973`*^9}, {3.9376362319433765`*^9, 
   3.9376362351220837`*^9}, {3.937636347463188*^9, 3.9376363519557877`*^9}, {
   3.9376366316827545`*^9, 3.937636748521101*^9}, {3.937636831723427*^9, 
   3.93763688677104*^9}, {3.937637031545891*^9, 3.9376370780055866`*^9}, {
   3.937637113929199*^9, 3.937637220422846*^9}, {3.9376372551130886`*^9, 
   3.937637308244028*^9}, {3.9376373476573467`*^9, 3.937637406535515*^9}, {
   3.9376374558463383`*^9, 3.937637547589367*^9}, {3.9376375784290524`*^9, 
   3.9376376458414993`*^9}, {3.9376376926816807`*^9, 
   3.9376377427232285`*^9}, {3.937637815269718*^9, 3.937638006644993*^9}, 
   3.937638131539238*^9, {3.9376382526047764`*^9, 3.9376383778615856`*^9}, {
   3.937638427631836*^9, 3.9376384457953606`*^9}, {3.9376384991287155`*^9, 
   3.937638556890009*^9}, {3.9376386785612183`*^9, 3.9376386807061844`*^9}, 
   3.937638718801607*^9, {3.937638756456089*^9, 3.937638805246828*^9}, {
   3.937639135678833*^9, 3.937639146248209*^9}, {3.9376392044773464`*^9, 
   3.9376392183913345`*^9}, {3.937639265823965*^9, 3.937639268936657*^9}, {
   3.937639307574539*^9, 3.937639383049654*^9}, 3.9376396634813385`*^9, {
   3.937640275495823*^9, 3.9376402800294647`*^9}, {3.937640481635622*^9, 
   3.9376404878876286`*^9}, {3.9376405201948166`*^9, 3.937640579828453*^9}, {
   3.9376406740112686`*^9, 3.937640697118286*^9}, {3.9376411569801083`*^9, 
   3.937641168825096*^9}, {3.9376412862195263`*^9, 3.937641376228302*^9}, 
   3.9376416844560757`*^9, 3.937641725270973*^9, {3.9376418272762775`*^9, 
   3.937641838503166*^9}, {3.937642051754429*^9, 3.9376420983479176`*^9}, 
   3.9376461052260036`*^9, {3.937649464136503*^9, 3.937649655653105*^9}, {
   3.9376496918131638`*^9, 3.937649903471182*^9}, {3.937649988547306*^9, 
   3.937650195922489*^9}, {3.9376502687999115`*^9, 3.9376503394171677`*^9}, {
   3.9376503914331665`*^9, 3.9376504244380608`*^9}, {3.9376504545612965`*^9, 
   3.9376505026856194`*^9}, {3.9376505511455326`*^9, 3.937650723070215*^9}, {
   3.9376508550984707`*^9, 3.937650863163862*^9}, {3.9376509203334656`*^9, 
   3.937650945087673*^9}, {3.93765104551042*^9, 3.9376511829815216`*^9}, {
   3.937651427126198*^9, 3.9376515772553864`*^9}, {3.9376516270518246`*^9, 
   3.9376516462229214`*^9}, 3.937651708853506*^9, {3.937651933314291*^9, 
   3.9376519973766823`*^9}, {3.9376520386997585`*^9, 3.937652078166788*^9}, {
   3.9376521149482765`*^9, 3.9376521737930584`*^9}, {3.937652247555382*^9, 
   3.937652272011904*^9}, {3.937652573305933*^9, 3.937652651598303*^9}, {
   3.937652710705511*^9, 3.937652719594286*^9}, {3.937652751537121*^9, 
   3.937652889792959*^9}, {3.937653424964319*^9, 3.937653440387474*^9}, {
   3.937653486630764*^9, 3.9376535219991455`*^9}, {3.9376537667703705`*^9, 
   3.9376537712246876`*^9}, {3.9376540126467857`*^9, 3.937654060140789*^9}, {
   3.937654127664316*^9, 3.937654209058943*^9}, {3.937654325815996*^9, 
   3.937654343851843*^9}, {3.937654431782078*^9, 3.9376544320266876`*^9}, {
   3.9376544649461403`*^9, 3.9376548808085117`*^9}, {3.9376549252184067`*^9, 
   3.9376549707353115`*^9}, {3.9376550093697586`*^9, 3.9376550287134*^9}, {
   3.937655240866829*^9, 3.9376552837707577`*^9}, {3.937655350320101*^9, 
   3.9376554619829845`*^9}, {3.9376555463594112`*^9, 3.93765557166185*^9}, {
   3.9376557816231804`*^9, 3.9376558587066593`*^9}, {3.9376559031095695`*^9, 
   3.937656009151085*^9}, {3.937656040345949*^9, 3.9376560744786167`*^9}, {
   3.937656108794525*^9, 3.937656303086073*^9}, {3.9376563545804825`*^9, 
   3.9376563910538673`*^9}, {3.937656438858263*^9, 3.93765648134387*^9}, {
   3.937656512473156*^9, 3.9376565660443363`*^9}, {3.937656680393984*^9, 
   3.9376567840551167`*^9}, {3.9376569111185017`*^9, 3.937656938609873*^9}, {
   3.9376569970376835`*^9, 3.9376570957105865`*^9}, {3.937657190793457*^9, 
   3.93765727117675*^9}, {3.937657340583193*^9, 3.9376573611231537`*^9}, {
   3.9376573951299953`*^9, 3.9376574529761486`*^9}, {3.9376574879749317`*^9, 
   3.937657506795227*^9}, {3.937657685805044*^9, 3.937657710149948*^9}, {
   3.937658879765518*^9, 3.937658960186018*^9}, {3.9376589973941193`*^9, 
   3.937659112643835*^9}, {3.937659154887083*^9, 3.937659228953888*^9}, {
   3.937659260009138*^9, 3.9376592611927414`*^9}, {3.937659315329296*^9, 
   3.937659371712679*^9}, {3.937659509775406*^9, 3.937659510423092*^9}, {
   3.937659553141968*^9, 3.9376595751577244`*^9}, {3.937659634766691*^9, 
   3.937659640409479*^9}, {3.9376596827090855`*^9, 3.937659722403181*^9}, {
   3.937659804559059*^9, 3.9376599282209816`*^9}, {3.9376599595802937`*^9, 
   3.9376600125880604`*^9}, {3.937660071283558*^9, 3.9376600766696644`*^9}, {
   3.9376601368856316`*^9, 3.9376601776762867`*^9}, {3.9376602339770985`*^9, 
   3.9376602439550343`*^9}, {3.93766047757798*^9, 3.937660483298315*^9}, {
   3.9376665349950047`*^9, 3.937666536944111*^9}, {3.937666568767618*^9, 
   3.937666604213175*^9}, {3.937666933178961*^9, 3.9376669333647804`*^9}, {
   3.937667081846863*^9, 3.937667082583967*^9}, {3.937673085853033*^9, 
   3.9376730891173477`*^9}, {3.937718200492319*^9, 3.937718398019949*^9}, {
   3.9377186411000824`*^9, 3.9377186471098824`*^9}, {3.9377186978806477`*^9, 
   3.9377187293472157`*^9}, {3.937718900482353*^9, 3.9377189830227413`*^9}, {
   3.9377191504441833`*^9, 3.9377191587472153`*^9}, {3.9377202004274063`*^9, 
   3.937720200607685*^9}, {3.9377202745932007`*^9, 3.9377203134196796`*^9}, {
   3.9377207457108*^9, 3.9377207599071693`*^9}, {3.978863504739044*^9, 
   3.9788635150283546`*^9}, 3.978863564341734*^9, {3.9788644224451733`*^9, 
   3.978864425390068*^9}},
 Background->RGBColor[
  0.88, 1, 0.88],ExpressionUUID->"c055d4f3-3809-4849-a2fe-7bcabfe65913"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"s", "=", 
   RowBox[{"1", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"n", "=", "201"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"steps", "=", "100"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"spinini", "=", 
   RowBox[{"SparseArray", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", "1", "}"}], "->", "1"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"2", "s"}], "+", "1"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"positionini", "=", 
    RowBox[{"SparseArray", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", "101", "}"}], "->", "1"}], ",", 
      RowBox[{"{", "n", "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"wavefunction", "=", 
    RowBox[{"Flatten", "[", 
     RowBox[{"KroneckerProduct", "[", 
      RowBox[{"spinini", ",", "positionini"}], "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"H", "=", 
   RowBox[{"KroneckerProduct", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"1", "/", 
       SqrtBox["2"]}], 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", 
          RowBox[{"-", "1"}]}], "}"}]}], "}"}]}], ",", 
     RowBox[{"IdentityMatrix", "[", "n", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"shift", "[", "wavefunction_", "]"}], ":=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"RotateLeft", "[", 
      RowBox[{"wavefunction", "[", 
       RowBox[{"[", 
        RowBox[{"1", ";;", "n"}], "]"}], "]"}], "]"}], ",", 
     RowBox[{"RotateRight", "[", 
      RowBox[{"wavefunction", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"n", "+", "1"}], ";;", 
         RowBox[{"2", "n"}]}], "]"}], "]"}], " ", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"coinandshift", "[", "wavefunction_", "]"}], ":=", 
    RowBox[{"shift", "[", 
     RowBox[{"H", ".", "wavefunction"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"wavefunctions", "=", 
    RowBox[{"Transpose", "[", 
     RowBox[{"NestList", "[", 
      RowBox[{"coinandshift", ",", "wavefunction", ",", "steps"}], "]"}], 
     "]"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{"the", " ", "key", " ", "is", " ", "using", " ", 
    RowBox[{"NestList", "[", "]"}], " ", "instead", " ", "of", " ", 
    RowBox[{"Nest", "[", "]"}], " ", "to", " ", "store", " ", "intermediate", 
    " ", "results"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"probabilities", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"Abs", "[", 
       RowBox[{"wavefunctions", "[", 
        RowBox[{"[", 
         RowBox[{"1", ";;", "n"}], "]"}], "]"}], "]"}], "^", "2"}], "+", 
     RowBox[{
      RowBox[{"Abs", "[", 
       RowBox[{"wavefunctions", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"n", "+", "1"}], ";;", 
          RowBox[{"2", "n"}]}], "]"}], "]"}], "]"}], "^", "2"}]}]}], ";"}], 
  " ", 
  RowBox[{"(*", 
   RowBox[{
   "we", " ", "store", " ", "the", " ", "probabilities", " ", "for", " ", 
    "every", " ", "step", " ", "taken"}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"frames", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"ListPlot", "[", 
       RowBox[{
        RowBox[{"probabilities", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", 
           RowBox[{"1", "+", "i"}]}], "]"}], "]"}], ",", 
        RowBox[{"DataRange", "->", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "100"}], ",", "100"}], "}"}]}], ",", 
        RowBox[{"PlotRange", "->", "Full"}], ",", 
        RowBox[{"Joined", "->", "True"}], ",", 
        RowBox[{"GridLines", "->", "Automatic"}], ",", 
        RowBox[{
        "PlotLabel", "->", 
         "\"\<Animated probability distribution for 1D quantum walk\>\""}], 
        ",", 
        RowBox[{"Frame", "->", "True"}], ",", 
        RowBox[{"FrameLabel", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\"\<Position\>\"", ",", "\"\<Probability\>\""}], "}"}]}], 
        ",", 
        RowBox[{"ImageSize", "->", "500"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "0", ",", "steps", ",", "1"}], "}"}]}], "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ListAnimate", "[", 
   RowBox[{"frames", ",", 
    RowBox[{"AnimationRunning", "->", "False"}]}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"ListDensityPlot", "[", 
  RowBox[{
   RowBox[{"Transpose", "[", "probabilities", "]"}], ",", 
   RowBox[{"DataRange", "->", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "100"}], ",", "100"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "steps"}], "}"}]}], "}"}]}], ",", 
   RowBox[{"PlotRange", "->", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0.15"}], "}"}]}], ",", 
   RowBox[{"AspectRatio", "->", 
    RowBox[{"steps", "/", "n"}]}], ",", 
   RowBox[{"InterpolationOrder", "\[Rule]", "0"}], ",", 
   RowBox[{
   "PlotLabel", "->", 
    "\"\<Probability distribution for 1D quantum walk at several steps\>\""}],
    ",", 
   RowBox[{"PlotLegends", "\[Rule]", "Automatic"}], ",", 
   RowBox[{"Frame", "->", "True"}], ",", 
   RowBox[{"FrameLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<Position\>\"", ",", "\"\<Step\>\""}], "}"}]}], ",", 
   RowBox[{"ImageSize", "->", "600"}]}], 
  "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.9371210554203663`*^9, 3.9371211223537273`*^9}, 
   3.9371212158161144`*^9, 3.9376283187763042`*^9, {3.9376283503186684`*^9, 
   3.937628463043869*^9}, {3.937628589862278*^9, 3.9376287170224648`*^9}, {
   3.9376289750151863`*^9, 3.9376290110332985`*^9}, {3.937629046627548*^9, 
   3.9376292220868435`*^9}, {3.9376292952296486`*^9, 
   3.9376293099044895`*^9}, {3.937629394158041*^9, 3.9376295119787464`*^9}, {
   3.9376297487521687`*^9, 3.937629837919245*^9}, {3.937629912247637*^9, 
   3.937629972841196*^9}, {3.937630088268343*^9, 3.937630117295601*^9}, {
   3.937630162335182*^9, 3.9376303648756294`*^9}, {3.937630425324274*^9, 
   3.937630447904564*^9}, {3.9376310981933765`*^9, 3.9376311356078644`*^9}, {
   3.937631202183607*^9, 3.937631259009451*^9}, {3.937631291364292*^9, 
   3.9376313135821934`*^9}, {3.937631348683321*^9, 3.9376313692178726`*^9}, {
   3.937631407608553*^9, 3.9376314127031097`*^9}, {3.9376315134897423`*^9, 
   3.937631578392145*^9}, {3.9376316101098385`*^9, 3.937631655282322*^9}, {
   3.937631703194359*^9, 3.9376317365512066`*^9}, {3.9376318463940296`*^9, 
   3.9376318473597317`*^9}, {3.9376326194713974`*^9, 3.9376326628643*^9}, {
   3.937632742923023*^9, 3.9376328437132893`*^9}, {3.9376329233939114`*^9, 
   3.9376329994053288`*^9}, {3.9376330342424107`*^9, 3.937633060236559*^9}, {
   3.9376342046593895`*^9, 3.937634208012888*^9}, {3.937634243899828*^9, 
   3.93763424655826*^9}, {3.9376359788286457`*^9, 3.937635987173435*^9}, {
   3.9376360353926105`*^9, 3.937636122034252*^9}, {3.937636162859995*^9, 
   3.9376361796847973`*^9}, {3.9376362319433765`*^9, 
   3.9376362351220837`*^9}, {3.937636347463188*^9, 3.9376363519557877`*^9}, {
   3.9376366316827545`*^9, 3.937636748521101*^9}, {3.937636831723427*^9, 
   3.93763688677104*^9}, {3.937637031545891*^9, 3.9376370780055866`*^9}, {
   3.937637113929199*^9, 3.937637220422846*^9}, {3.9376372551130886`*^9, 
   3.937637308244028*^9}, {3.9376373476573467`*^9, 3.937637406535515*^9}, {
   3.9376374558463383`*^9, 3.937637547589367*^9}, {3.9376375784290524`*^9, 
   3.9376376458414993`*^9}, {3.9376376926816807`*^9, 
   3.9376377427232285`*^9}, {3.937637815269718*^9, 3.937638006644993*^9}, 
   3.937638131539238*^9, {3.9376382526047764`*^9, 3.9376383778615856`*^9}, {
   3.937638427631836*^9, 3.9376384457953606`*^9}, {3.9376384991287155`*^9, 
   3.937638556890009*^9}, {3.9376386785612183`*^9, 3.9376386807061844`*^9}, 
   3.937638718801607*^9, {3.937638756456089*^9, 3.937638805246828*^9}, {
   3.937639135678833*^9, 3.937639146248209*^9}, {3.9376392044773464`*^9, 
   3.9376392183913345`*^9}, {3.937639265823965*^9, 3.937639268936657*^9}, {
   3.937639307574539*^9, 3.937639383049654*^9}, 3.9376396634813385`*^9, {
   3.937640275495823*^9, 3.9376402800294647`*^9}, {3.937640481635622*^9, 
   3.9376404878876286`*^9}, {3.9376405201948166`*^9, 3.937640579828453*^9}, {
   3.9376406740112686`*^9, 3.937640697118286*^9}, {3.9376411569801083`*^9, 
   3.937641168825096*^9}, {3.9376412862195263`*^9, 3.937641376228302*^9}, 
   3.9376416844560757`*^9, 3.937641725270973*^9, {3.9376418272762775`*^9, 
   3.937641838503166*^9}, {3.937642051754429*^9, 3.9376420983479176`*^9}, 
   3.9376461052260036`*^9, {3.937649464136503*^9, 3.937649655653105*^9}, {
   3.9376496918131638`*^9, 3.937649903471182*^9}, {3.937649988547306*^9, 
   3.937650195922489*^9}, {3.9376502687999115`*^9, 3.9376503394171677`*^9}, {
   3.9376503914331665`*^9, 3.9376504244380608`*^9}, {3.9376504545612965`*^9, 
   3.9376505026856194`*^9}, {3.9376505511455326`*^9, 3.937650723070215*^9}, {
   3.9376508550984707`*^9, 3.937650863163862*^9}, {3.9376509203334656`*^9, 
   3.937650945087673*^9}, {3.93765104551042*^9, 3.9376511829815216`*^9}, {
   3.937651427126198*^9, 3.9376515772553864`*^9}, {3.9376516270518246`*^9, 
   3.9376516462229214`*^9}, 3.937651708853506*^9, {3.937651933314291*^9, 
   3.9376519973766823`*^9}, {3.9376520386997585`*^9, 3.937652078166788*^9}, {
   3.9376521149482765`*^9, 3.9376521737930584`*^9}, {3.937652247555382*^9, 
   3.937652272011904*^9}, {3.937652573305933*^9, 3.937652651598303*^9}, {
   3.937652710705511*^9, 3.937652719594286*^9}, {3.937652751537121*^9, 
   3.937652889792959*^9}, {3.937653424964319*^9, 3.937653440387474*^9}, {
   3.937653486630764*^9, 3.9376535219991455`*^9}, {3.9376537667703705`*^9, 
   3.9376537712246876`*^9}, {3.9376540126467857`*^9, 3.937654060140789*^9}, {
   3.937654127664316*^9, 3.937654209058943*^9}, {3.937654325815996*^9, 
   3.937654343851843*^9}, {3.937654431782078*^9, 3.9376544320266876`*^9}, {
   3.9376544649461403`*^9, 3.9376548808085117`*^9}, {3.9376549252184067`*^9, 
   3.9376549707353115`*^9}, {3.9376550093697586`*^9, 3.9376550287134*^9}, {
   3.937655240866829*^9, 3.9376552837707577`*^9}, {3.937655350320101*^9, 
   3.9376554619829845`*^9}, {3.9376555463594112`*^9, 3.93765557166185*^9}, {
   3.9376557816231804`*^9, 3.9376558587066593`*^9}, {3.9376559031095695`*^9, 
   3.937656009151085*^9}, {3.937656040345949*^9, 3.9376560744786167`*^9}, {
   3.937656108794525*^9, 3.937656303086073*^9}, {3.9376563545804825`*^9, 
   3.9376563910538673`*^9}, {3.937656438858263*^9, 3.93765648134387*^9}, {
   3.937656512473156*^9, 3.9376565660443363`*^9}, {3.937656680393984*^9, 
   3.9376567840551167`*^9}, {3.9376569111185017`*^9, 3.937656938609873*^9}, {
   3.9376569970376835`*^9, 3.9376570957105865`*^9}, {3.937657190793457*^9, 
   3.93765727117675*^9}, {3.937657340583193*^9, 3.9376573611231537`*^9}, {
   3.9376573951299953`*^9, 3.9376574529761486`*^9}, {3.9376574879749317`*^9, 
   3.937657506795227*^9}, {3.937657685805044*^9, 3.937657710149948*^9}, {
   3.937658879765518*^9, 3.937658960186018*^9}, {3.9376589973941193`*^9, 
   3.937659112643835*^9}, {3.937659154887083*^9, 3.937659228953888*^9}, {
   3.937659260009138*^9, 3.9376592611927414`*^9}, {3.937659315329296*^9, 
   3.937659371712679*^9}, {3.937659509775406*^9, 3.937659510423092*^9}, {
   3.937659553141968*^9, 3.9376595751577244`*^9}, {3.937659634766691*^9, 
   3.937659640409479*^9}, {3.9376596827090855`*^9, 3.937659722403181*^9}, {
   3.937659804559059*^9, 3.9376599282209816`*^9}, {3.9376599595802937`*^9, 
   3.9376600125880604`*^9}, {3.937660071283558*^9, 3.9376600766696644`*^9}, {
   3.9376601368856316`*^9, 3.9376601776762867`*^9}, {3.9376602339770985`*^9, 
   3.9376602439550343`*^9}, {3.93766047757798*^9, 3.937660483298315*^9}, {
   3.9376665349950047`*^9, 3.937666536944111*^9}, {3.937666568767618*^9, 
   3.9376665884021435`*^9}, {3.937666672385891*^9, 3.9376666763570156`*^9}, {
   3.937666764485359*^9, 3.9376667653410645`*^9}, {3.9376668336484127`*^9, 
   3.937666840008732*^9}, {3.9376669812574863`*^9, 3.9376669817528133`*^9}, {
   3.937667088477049*^9, 3.937667118666363*^9}, {3.9376676474717903`*^9, 
   3.937667881530184*^9}, {3.93766905441786*^9, 3.937669092660866*^9}, {
   3.937673079366604*^9, 3.9376730823648643`*^9}, {3.937673424410021*^9, 
   3.937673442800577*^9}, {3.9376735023900776`*^9, 3.93767353898892*^9}, {
   3.937673571082924*^9, 3.937673622666813*^9}, {3.9376736836224403`*^9, 
   3.9376738947095623`*^9}, {3.9376740857012157`*^9, 3.9376740860268345`*^9}, 
   3.93767420893458*^9, {3.937674245944515*^9, 3.937674267111679*^9}, {
   3.9376744499116077`*^9, 3.9376745447033005`*^9}, {3.9376745766879387`*^9, 
   3.9376746264088993`*^9}, {3.9376747999807987`*^9, 3.937674802784582*^9}, {
   3.9376748773332005`*^9, 3.9376749227769585`*^9}, {3.9376752009261303`*^9, 
   3.9376752368718967`*^9}, {3.937677572671257*^9, 3.937677582859667*^9}, {
   3.9377188642440777`*^9, 3.9377188896738625`*^9}, {3.937719010504305*^9, 
   3.937719029983959*^9}, {3.937719328645769*^9, 3.937719346600321*^9}, {
   3.9377194851321125`*^9, 3.9377194863544006`*^9}, {3.9377195683737793`*^9, 
   3.937719596609621*^9}, {3.937719959521885*^9, 3.937719991769127*^9}, {
   3.9377225728185463`*^9, 3.9377226500736084`*^9}, {3.9377227456877136`*^9, 
   3.9377227472459087`*^9}, 3.9377227873939342`*^9, {3.9377228249887714`*^9, 
   3.937722825609083*^9}, 3.937722886329258*^9, {3.9377229871179047`*^9, 
   3.9377230213705177`*^9}, {3.937728272590929*^9, 3.937728276220579*^9}, 
   3.937823885918621*^9, {3.9379668150604057`*^9, 3.9379668233166237`*^9}, {
   3.937966857967598*^9, 3.937966858792261*^9}, {3.9379671311162567`*^9, 
   3.937967131677595*^9}, 3.978860751811468*^9, {3.9788619115839386`*^9, 
   3.978861941755493*^9}, 3.9788620188900166`*^9, {3.9788621581443405`*^9, 
   3.978862159645012*^9}, 3.978862212948393*^9, {3.978862256606741*^9, 
   3.978862257375511*^9}},
 CellLabel->"In[14]:=",ExpressionUUID->"54a247a7-1b0f-9e49-be77-bdcf25323aa4"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Simulation 3: Animated probability distribution for 1D quantum walk with \
symmetric initial conditions\
\>", "Chapter",
 CellChangeTimes->{{3.937718652475172*^9, 3.93771866424946*^9}, 
   3.937718758111515*^9, 3.937718793419386*^9, {3.9377188428774986`*^9, 
   3.9377188589349155`*^9}, {3.937719039971689*^9, 3.9377190428464355`*^9}, {
   3.9377209996313896`*^9, 
   3.9377210092484455`*^9}},ExpressionUUID->"7c9fe1ca-b380-1242-8b13-\
974094edc5b1"],

Cell[TextData[{
 "We modify the initial coin (spin) state to show how it affects the \
probability distribution [1]. Starting from ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"|", "0"}], "\[RightAngleBracket]"}], TraditionalForm]],
  ExpressionUUID->"096423bf-889a-d44e-b919-8d18fc9fefb6"],
 " biases the walk to the left because the conditional shift sends spin-up \
left and spin-down right, even if after one Hadamard step the spin \
measurement probabilities are ",
 Cell[BoxData[
  FormBox[
   RowBox[{"1", "/", "2"}], TraditionalForm]],ExpressionUUID->
  "996ad96d-d6f2-bc4c-b336-091416e00b2b"],
 " and ",
 Cell[BoxData[
  FormBox[
   RowBox[{"1", "/", "2"}], TraditionalForm]],ExpressionUUID->
  "894bfa0d-83d2-9446-bacd-d6d56a2312bb"],
 ". A symmetric distribution is obtained by choosing the initial coin state ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"1", "/", 
          RowBox[{"Sqrt", "[", "2", "]"}]}], 
         RowBox[{"(", 
          RowBox[{"|", "0"}]}]}], "\[RightAngleBracket]"}], "-", "i"}], "|", 
      "1"}], "\[RightAngleBracket]"}], ")"}], TraditionalForm]],
  ExpressionUUID->"298c6672-2c5f-5c4e-8e3c-77abc93e68eb"],
 ", i.e., by setting an appropriate relative phase between ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"|", "0"}], "\[RightAngleBracket]"}], TraditionalForm]],
  ExpressionUUID->"3771d03f-b2ec-0244-8a68-27bd94df5d90"],
 "  and ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"|", "1"}], "\[RightAngleBracket]"}], TraditionalForm]],
  ExpressionUUID->"ce34dee9-4337-ec47-9b94-ed9cb30cabcd"],
 " ."
}], "Text",
 CellFrame->{{0, 0}, {0, 0}},
 CellChangeTimes->{{3.9371210554203663`*^9, 3.9371211223537273`*^9}, 
   3.9371212158161144`*^9, 3.9376283187763042`*^9, {3.9376283503186684`*^9, 
   3.937628463043869*^9}, {3.937628589862278*^9, 3.9376287170224648`*^9}, {
   3.9376289750151863`*^9, 3.9376290110332985`*^9}, {3.937629046627548*^9, 
   3.9376292220868435`*^9}, {3.9376292952296486`*^9, 
   3.9376293099044895`*^9}, {3.937629394158041*^9, 3.9376295119787464`*^9}, {
   3.9376297487521687`*^9, 3.937629837919245*^9}, {3.937629912247637*^9, 
   3.937629972841196*^9}, {3.937630088268343*^9, 3.937630117295601*^9}, {
   3.937630162335182*^9, 3.9376303648756294`*^9}, {3.937630425324274*^9, 
   3.937630447904564*^9}, {3.9376310981933765`*^9, 3.9376311356078644`*^9}, {
   3.937631202183607*^9, 3.937631259009451*^9}, {3.937631291364292*^9, 
   3.9376313135821934`*^9}, {3.937631348683321*^9, 3.9376313692178726`*^9}, {
   3.937631407608553*^9, 3.9376314127031097`*^9}, {3.9376315134897423`*^9, 
   3.937631578392145*^9}, {3.9376316101098385`*^9, 3.937631655282322*^9}, {
   3.937631703194359*^9, 3.9376317365512066`*^9}, {3.9376318463940296`*^9, 
   3.9376318473597317`*^9}, {3.9376326194713974`*^9, 3.9376326628643*^9}, {
   3.937632742923023*^9, 3.9376328437132893`*^9}, {3.9376329233939114`*^9, 
   3.9376329994053288`*^9}, {3.9376330342424107`*^9, 3.937633060236559*^9}, {
   3.9376342046593895`*^9, 3.937634208012888*^9}, {3.937634243899828*^9, 
   3.93763424655826*^9}, {3.9376359788286457`*^9, 3.937635987173435*^9}, {
   3.9376360353926105`*^9, 3.937636122034252*^9}, {3.937636162859995*^9, 
   3.9376361796847973`*^9}, {3.9376362319433765`*^9, 
   3.9376362351220837`*^9}, {3.937636347463188*^9, 3.9376363519557877`*^9}, {
   3.9376366316827545`*^9, 3.937636748521101*^9}, {3.937636831723427*^9, 
   3.93763688677104*^9}, {3.937637031545891*^9, 3.9376370780055866`*^9}, {
   3.937637113929199*^9, 3.937637220422846*^9}, {3.9376372551130886`*^9, 
   3.937637308244028*^9}, {3.9376373476573467`*^9, 3.937637406535515*^9}, {
   3.9376374558463383`*^9, 3.937637547589367*^9}, {3.9376375784290524`*^9, 
   3.9376376458414993`*^9}, {3.9376376926816807`*^9, 
   3.9376377427232285`*^9}, {3.937637815269718*^9, 3.937638006644993*^9}, 
   3.937638131539238*^9, {3.9376382526047764`*^9, 3.9376383778615856`*^9}, {
   3.937638427631836*^9, 3.9376384457953606`*^9}, {3.9376384991287155`*^9, 
   3.937638556890009*^9}, {3.9376386785612183`*^9, 3.9376386807061844`*^9}, 
   3.937638718801607*^9, {3.937638756456089*^9, 3.937638805246828*^9}, {
   3.937639135678833*^9, 3.937639146248209*^9}, {3.9376392044773464`*^9, 
   3.9376392183913345`*^9}, {3.937639265823965*^9, 3.937639268936657*^9}, {
   3.937639307574539*^9, 3.937639383049654*^9}, 3.9376396634813385`*^9, {
   3.937640275495823*^9, 3.9376402800294647`*^9}, {3.937640481635622*^9, 
   3.9376404878876286`*^9}, {3.9376405201948166`*^9, 3.937640579828453*^9}, {
   3.9376406740112686`*^9, 3.937640697118286*^9}, {3.9376411569801083`*^9, 
   3.937641168825096*^9}, {3.9376412862195263`*^9, 3.937641376228302*^9}, 
   3.9376416844560757`*^9, 3.937641725270973*^9, {3.9376418272762775`*^9, 
   3.937641838503166*^9}, {3.937642051754429*^9, 3.9376420983479176`*^9}, 
   3.9376461052260036`*^9, {3.937649464136503*^9, 3.937649655653105*^9}, {
   3.9376496918131638`*^9, 3.937649903471182*^9}, {3.937649988547306*^9, 
   3.937650195922489*^9}, {3.9376502687999115`*^9, 3.9376503394171677`*^9}, {
   3.9376503914331665`*^9, 3.9376504244380608`*^9}, {3.9376504545612965`*^9, 
   3.9376505026856194`*^9}, {3.9376505511455326`*^9, 3.937650723070215*^9}, {
   3.9376508550984707`*^9, 3.937650863163862*^9}, {3.9376509203334656`*^9, 
   3.937650945087673*^9}, {3.93765104551042*^9, 3.9376511829815216`*^9}, {
   3.937651427126198*^9, 3.9376515772553864`*^9}, {3.9376516270518246`*^9, 
   3.9376516462229214`*^9}, 3.937651708853506*^9, {3.937651933314291*^9, 
   3.9376519973766823`*^9}, {3.9376520386997585`*^9, 3.937652078166788*^9}, {
   3.9376521149482765`*^9, 3.9376521737930584`*^9}, {3.937652247555382*^9, 
   3.937652272011904*^9}, {3.937652573305933*^9, 3.937652651598303*^9}, {
   3.937652710705511*^9, 3.937652719594286*^9}, {3.937652751537121*^9, 
   3.937652889792959*^9}, {3.937653424964319*^9, 3.937653440387474*^9}, {
   3.937653486630764*^9, 3.9376535219991455`*^9}, {3.9376537667703705`*^9, 
   3.9376537712246876`*^9}, {3.9376540126467857`*^9, 3.937654060140789*^9}, {
   3.937654127664316*^9, 3.937654209058943*^9}, {3.937654325815996*^9, 
   3.937654343851843*^9}, {3.937654431782078*^9, 3.9376544320266876`*^9}, {
   3.9376544649461403`*^9, 3.9376548808085117`*^9}, {3.9376549252184067`*^9, 
   3.9376549707353115`*^9}, {3.9376550093697586`*^9, 3.9376550287134*^9}, {
   3.937655240866829*^9, 3.9376552837707577`*^9}, {3.937655350320101*^9, 
   3.9376554619829845`*^9}, {3.9376555463594112`*^9, 3.93765557166185*^9}, {
   3.9376557816231804`*^9, 3.9376558587066593`*^9}, {3.9376559031095695`*^9, 
   3.937656009151085*^9}, {3.937656040345949*^9, 3.9376560744786167`*^9}, {
   3.937656108794525*^9, 3.937656303086073*^9}, {3.9376563545804825`*^9, 
   3.9376563910538673`*^9}, {3.937656438858263*^9, 3.93765648134387*^9}, {
   3.937656512473156*^9, 3.9376565660443363`*^9}, {3.937656680393984*^9, 
   3.9376567840551167`*^9}, {3.9376569111185017`*^9, 3.937656938609873*^9}, {
   3.9376569970376835`*^9, 3.9376570957105865`*^9}, {3.937657190793457*^9, 
   3.93765727117675*^9}, {3.937657340583193*^9, 3.9376573611231537`*^9}, {
   3.9376573951299953`*^9, 3.9376574529761486`*^9}, {3.9376574879749317`*^9, 
   3.937657506795227*^9}, {3.937657685805044*^9, 3.937657710149948*^9}, {
   3.937658879765518*^9, 3.937658960186018*^9}, {3.9376589973941193`*^9, 
   3.937659112643835*^9}, {3.937659154887083*^9, 3.937659228953888*^9}, {
   3.937659260009138*^9, 3.9376592611927414`*^9}, {3.937659315329296*^9, 
   3.937659371712679*^9}, {3.937659509775406*^9, 3.937659510423092*^9}, {
   3.937659553141968*^9, 3.9376595751577244`*^9}, {3.937659634766691*^9, 
   3.937659640409479*^9}, {3.9376596827090855`*^9, 3.937659722403181*^9}, {
   3.937659804559059*^9, 3.9376599282209816`*^9}, {3.9376599595802937`*^9, 
   3.9376600125880604`*^9}, {3.937660071283558*^9, 3.9376600766696644`*^9}, {
   3.9376601368856316`*^9, 3.9376601776762867`*^9}, {3.9376602339770985`*^9, 
   3.9376602439550343`*^9}, {3.93766047757798*^9, 3.937660483298315*^9}, {
   3.9376665349950047`*^9, 3.937666536944111*^9}, {3.937666568767618*^9, 
   3.937666604213175*^9}, {3.937666933178961*^9, 3.9376669333647804`*^9}, {
   3.937667081846863*^9, 3.937667082583967*^9}, {3.937673085853033*^9, 
   3.9376730891173477`*^9}, {3.937718200492319*^9, 3.937718398019949*^9}, {
   3.9377186411000824`*^9, 3.9377186471098824`*^9}, {3.9377186978806477`*^9, 
   3.9377187293472157`*^9}, {3.937718900482353*^9, 3.9377189830227413`*^9}, 
   3.9377190436822376`*^9, {3.9377201275761337`*^9, 3.937720128438057*^9}, {
   3.937720823569439*^9, 3.9377209068563023`*^9}, {3.937721015771387*^9, 
   3.937721321223633*^9}, {3.9788635775015583`*^9, 3.978863594466984*^9}, 
   3.9788636503493633`*^9, {3.9788636870929146`*^9, 3.978863754525179*^9}, {
   3.97886378970804*^9, 3.9788637903014565`*^9}, {3.9788638308305645`*^9, 
   3.9788638314718876`*^9}, {3.978864565111231*^9, 3.9788645665986176`*^9}},
 Background->RGBColor[
  0.88, 1, 0.88],ExpressionUUID->"89b146f3-d661-7a42-a272-d9bfa2241069"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"s", "=", 
   RowBox[{"1", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"n", "=", "201"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"steps", "=", "100"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"spinini", "=", 
    RowBox[{"SparseArray", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"{", "1", "}"}], "->", 
         RowBox[{"1", "/", 
          SqrtBox["2"]}]}], ",", 
        RowBox[{
         RowBox[{"{", "2", "}"}], "->", 
         RowBox[{"I", "/", 
          SqrtBox["2"]}]}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"2", "s"}], "+", "1"}], "}"}]}], "]"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{"symmetric", " ", "initial", " ", "conditions"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"positionini", "=", 
    RowBox[{"SparseArray", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", "101", "}"}], "->", "1"}], ",", 
      RowBox[{"{", "n", "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"wavefunction", "=", 
    RowBox[{"Flatten", "[", 
     RowBox[{"KroneckerProduct", "[", 
      RowBox[{"spinini", ",", "positionini"}], "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"H", "=", 
   RowBox[{"KroneckerProduct", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"1", "/", 
       SqrtBox["2"]}], 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", 
          RowBox[{"-", "1"}]}], "}"}]}], "}"}]}], ",", 
     RowBox[{"IdentityMatrix", "[", "n", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"shift", "[", "wavefunction_", "]"}], ":=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"RotateLeft", "[", 
      RowBox[{"wavefunction", "[", 
       RowBox[{"[", 
        RowBox[{"1", ";;", "n"}], "]"}], "]"}], "]"}], ",", 
     RowBox[{"RotateRight", "[", 
      RowBox[{"wavefunction", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"n", "+", "1"}], ";;", 
         RowBox[{"2", "n"}]}], "]"}], "]"}], " ", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"coinandshift", "[", "wavefunction_", "]"}], ":=", 
    RowBox[{"shift", "[", 
     RowBox[{"H", ".", "wavefunction"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"wavefunctions", "=", 
   RowBox[{"Transpose", "[", 
    RowBox[{"NestList", "[", 
     RowBox[{"coinandshift", ",", "wavefunction", ",", "steps"}], "]"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"probabilities", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"Abs", "[", 
       RowBox[{"wavefunctions", "[", 
        RowBox[{"[", 
         RowBox[{"1", ";;", "n"}], "]"}], "]"}], "]"}], "^", "2"}], "+", 
     RowBox[{
      RowBox[{"Abs", "[", 
       RowBox[{"wavefunctions", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"n", "+", "1"}], ";;", 
          RowBox[{"2", "n"}]}], "]"}], "]"}], "]"}], "^", "2"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"frames", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"ListPlot", "[", 
       RowBox[{
        RowBox[{"probabilities", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", 
           RowBox[{"1", "+", "i"}]}], "]"}], "]"}], ",", 
        RowBox[{"DataRange", "->", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "100"}], ",", "100"}], "}"}]}], ",", 
        RowBox[{"PlotRange", "->", "Full"}], ",", 
        RowBox[{"Joined", "->", "True"}], ",", 
        RowBox[{"GridLines", "->", "Automatic"}], ",", 
        RowBox[{
        "PlotLabel", "->", 
         "\"\<Animated probability distribution for 1D quantum walk with \
symmetric initial conditions\>\""}], ",", 
        RowBox[{"Frame", "->", "True"}], ",", 
        RowBox[{"FrameLabel", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\"\<Position\>\"", ",", "\"\<Probability\>\""}], "}"}]}], 
        ",", 
        RowBox[{"ImageSize", "->", "500"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "0", ",", "steps", ",", "1"}], "}"}]}], "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ListAnimate", "[", 
   RowBox[{"frames", ",", 
    RowBox[{"AnimationRunning", "->", "False"}]}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"ListDensityPlot", "[", 
  RowBox[{
   RowBox[{"Transpose", "[", "probabilities", "]"}], ",", 
   RowBox[{"DataRange", "->", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "100"}], ",", "100"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "steps"}], "}"}]}], "}"}]}], ",", 
   RowBox[{"PlotRange", "->", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0.15"}], "}"}]}], ",", 
   RowBox[{"AspectRatio", "->", 
    RowBox[{"steps", "/", "n"}]}], ",", 
   RowBox[{"InterpolationOrder", "\[Rule]", "0"}], ",", 
   RowBox[{
   "PlotLabel", "->", 
    "\"\<Probability distribution for 1D quantum walk at several steps with \
symmetric initial conditions\>\""}], ",", 
   RowBox[{"PlotLegends", "\[Rule]", "Automatic"}], ",", 
   RowBox[{"Frame", "->", "True"}], ",", 
   RowBox[{"FrameLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<Position\>\"", ",", "\"\<Step\>\""}], "}"}]}], ",", 
   RowBox[{"ImageSize", "->", "600"}]}], 
  "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.937666823943924*^9, 3.9376668254592896`*^9}, {
   3.937666966917761*^9, 3.93766696759317*^9}, 3.937667114206873*^9, {
   3.9376691131431847`*^9, 3.937669251888937*^9}, {3.937669373794445*^9, 
   3.937669416916397*^9}, {3.9376694488406506`*^9, 3.9376695338381844`*^9}, {
   3.9376696558627224`*^9, 3.9376698027042885`*^9}, 3.9377208403490353`*^9, 
   3.937720919805193*^9, {3.937721361556692*^9, 3.9377213661370487`*^9}, {
   3.9377226580146427`*^9, 3.9377226858004684`*^9}, {3.9377230853900223`*^9, 
   3.9377231208754654`*^9}, {3.9377283006334076`*^9, 3.9377283049338684`*^9}, 
   3.9378200750539017`*^9, 3.9379652395489025`*^9, {3.937966881039852*^9, 
   3.9379669250811996`*^9}, {3.9379671239453125`*^9, 3.937967124510023*^9}, {
   3.9788622775395794`*^9, 3.978862297852417*^9}},
 CellLabel->"In[29]:=",ExpressionUUID->"1d8fd0da-8a00-e646-9b0d-dc711820f018"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Simulation 4: Periodic boundary conditions", "Chapter",
 CellChangeTimes->{{3.937718652475172*^9, 3.93771866424946*^9}, 
   3.937718758111515*^9, 3.937718793419386*^9, {3.9377188428774986`*^9, 
   3.9377188589349155`*^9}, {3.9377190508245373`*^9, 3.937719052386072*^9}, {
   3.9377214471588116`*^9, 3.9377214504912624`*^9}, {3.937724624738554*^9, 
   3.9377246506878433`*^9}},ExpressionUUID->"6ce1876c-57d6-9148-965e-\
4374665a3ead"],

Cell[TextData[{
 "Keeping the symmetric initial coin state, we verify that periodic \
(wrap-around) boundary conditions are correctly implemented [1]. With \
periodic boundaries, probability that reaches one end of the lattice \
reappears at the opposite end after the shift operation. To make this \
behavior easy to see, we reduce the lattice to ",
 Cell[BoxData[
  FormBox[
   RowBox[{"n", "=", "51"}], TraditionalForm]],ExpressionUUID->
  "4ba82bf9-275a-f94d-ba14-52b7277e3102"],
 " sites and plot the distribution near the boundaries."
}], "Text",
 CellFrame->{{0, 0}, {0, 0}},
 CellChangeTimes->{{3.9371210554203663`*^9, 3.9371211223537273`*^9}, 
   3.9371212158161144`*^9, 3.9376283187763042`*^9, {3.9376283503186684`*^9, 
   3.937628463043869*^9}, {3.937628589862278*^9, 3.9376287170224648`*^9}, {
   3.9376289750151863`*^9, 3.9376290110332985`*^9}, {3.937629046627548*^9, 
   3.9376292220868435`*^9}, {3.9376292952296486`*^9, 
   3.9376293099044895`*^9}, {3.937629394158041*^9, 3.9376295119787464`*^9}, {
   3.9376297487521687`*^9, 3.937629837919245*^9}, {3.937629912247637*^9, 
   3.937629972841196*^9}, {3.937630088268343*^9, 3.937630117295601*^9}, {
   3.937630162335182*^9, 3.9376303648756294`*^9}, {3.937630425324274*^9, 
   3.937630447904564*^9}, {3.9376310981933765`*^9, 3.9376311356078644`*^9}, {
   3.937631202183607*^9, 3.937631259009451*^9}, {3.937631291364292*^9, 
   3.9376313135821934`*^9}, {3.937631348683321*^9, 3.9376313692178726`*^9}, {
   3.937631407608553*^9, 3.9376314127031097`*^9}, {3.9376315134897423`*^9, 
   3.937631578392145*^9}, {3.9376316101098385`*^9, 3.937631655282322*^9}, {
   3.937631703194359*^9, 3.9376317365512066`*^9}, {3.9376318463940296`*^9, 
   3.9376318473597317`*^9}, {3.9376326194713974`*^9, 3.9376326628643*^9}, {
   3.937632742923023*^9, 3.9376328437132893`*^9}, {3.9376329233939114`*^9, 
   3.9376329994053288`*^9}, {3.9376330342424107`*^9, 3.937633060236559*^9}, {
   3.9376342046593895`*^9, 3.937634208012888*^9}, {3.937634243899828*^9, 
   3.93763424655826*^9}, {3.9376359788286457`*^9, 3.937635987173435*^9}, {
   3.9376360353926105`*^9, 3.937636122034252*^9}, {3.937636162859995*^9, 
   3.9376361796847973`*^9}, {3.9376362319433765`*^9, 
   3.9376362351220837`*^9}, {3.937636347463188*^9, 3.9376363519557877`*^9}, {
   3.9376366316827545`*^9, 3.937636748521101*^9}, {3.937636831723427*^9, 
   3.93763688677104*^9}, {3.937637031545891*^9, 3.9376370780055866`*^9}, {
   3.937637113929199*^9, 3.937637220422846*^9}, {3.9376372551130886`*^9, 
   3.937637308244028*^9}, {3.9376373476573467`*^9, 3.937637406535515*^9}, {
   3.9376374558463383`*^9, 3.937637547589367*^9}, {3.9376375784290524`*^9, 
   3.9376376458414993`*^9}, {3.9376376926816807`*^9, 
   3.9376377427232285`*^9}, {3.937637815269718*^9, 3.937638006644993*^9}, 
   3.937638131539238*^9, {3.9376382526047764`*^9, 3.9376383778615856`*^9}, {
   3.937638427631836*^9, 3.9376384457953606`*^9}, {3.9376384991287155`*^9, 
   3.937638556890009*^9}, {3.9376386785612183`*^9, 3.9376386807061844`*^9}, 
   3.937638718801607*^9, {3.937638756456089*^9, 3.937638805246828*^9}, {
   3.937639135678833*^9, 3.937639146248209*^9}, {3.9376392044773464`*^9, 
   3.9376392183913345`*^9}, {3.937639265823965*^9, 3.937639268936657*^9}, {
   3.937639307574539*^9, 3.937639383049654*^9}, 3.9376396634813385`*^9, {
   3.937640275495823*^9, 3.9376402800294647`*^9}, {3.937640481635622*^9, 
   3.9376404878876286`*^9}, {3.9376405201948166`*^9, 3.937640579828453*^9}, {
   3.9376406740112686`*^9, 3.937640697118286*^9}, {3.9376411569801083`*^9, 
   3.937641168825096*^9}, {3.9376412862195263`*^9, 3.937641376228302*^9}, 
   3.9376416844560757`*^9, 3.937641725270973*^9, {3.9376418272762775`*^9, 
   3.937641838503166*^9}, {3.937642051754429*^9, 3.9376420983479176`*^9}, 
   3.9376461052260036`*^9, {3.937649464136503*^9, 3.937649655653105*^9}, {
   3.9376496918131638`*^9, 3.937649903471182*^9}, {3.937649988547306*^9, 
   3.937650195922489*^9}, {3.9376502687999115`*^9, 3.9376503394171677`*^9}, {
   3.9376503914331665`*^9, 3.9376504244380608`*^9}, {3.9376504545612965`*^9, 
   3.9376505026856194`*^9}, {3.9376505511455326`*^9, 3.937650723070215*^9}, {
   3.9376508550984707`*^9, 3.937650863163862*^9}, {3.9376509203334656`*^9, 
   3.937650945087673*^9}, {3.93765104551042*^9, 3.9376511829815216`*^9}, {
   3.937651427126198*^9, 3.9376515772553864`*^9}, {3.9376516270518246`*^9, 
   3.9376516462229214`*^9}, 3.937651708853506*^9, {3.937651933314291*^9, 
   3.9376519973766823`*^9}, {3.9376520386997585`*^9, 3.937652078166788*^9}, {
   3.9376521149482765`*^9, 3.9376521737930584`*^9}, {3.937652247555382*^9, 
   3.937652272011904*^9}, {3.937652573305933*^9, 3.937652651598303*^9}, {
   3.937652710705511*^9, 3.937652719594286*^9}, {3.937652751537121*^9, 
   3.937652889792959*^9}, {3.937653424964319*^9, 3.937653440387474*^9}, {
   3.937653486630764*^9, 3.9376535219991455`*^9}, {3.9376537667703705`*^9, 
   3.9376537712246876`*^9}, {3.9376540126467857`*^9, 3.937654060140789*^9}, {
   3.937654127664316*^9, 3.937654209058943*^9}, {3.937654325815996*^9, 
   3.937654343851843*^9}, {3.937654431782078*^9, 3.9376544320266876`*^9}, {
   3.9376544649461403`*^9, 3.9376548808085117`*^9}, {3.9376549252184067`*^9, 
   3.9376549707353115`*^9}, {3.9376550093697586`*^9, 3.9376550287134*^9}, {
   3.937655240866829*^9, 3.9376552837707577`*^9}, {3.937655350320101*^9, 
   3.9376554619829845`*^9}, {3.9376555463594112`*^9, 3.93765557166185*^9}, {
   3.9376557816231804`*^9, 3.9376558587066593`*^9}, {3.9376559031095695`*^9, 
   3.937656009151085*^9}, {3.937656040345949*^9, 3.9376560744786167`*^9}, {
   3.937656108794525*^9, 3.937656303086073*^9}, {3.9376563545804825`*^9, 
   3.9376563910538673`*^9}, {3.937656438858263*^9, 3.93765648134387*^9}, {
   3.937656512473156*^9, 3.9376565660443363`*^9}, {3.937656680393984*^9, 
   3.9376567840551167`*^9}, {3.9376569111185017`*^9, 3.937656938609873*^9}, {
   3.9376569970376835`*^9, 3.9376570957105865`*^9}, {3.937657190793457*^9, 
   3.93765727117675*^9}, {3.937657340583193*^9, 3.9376573611231537`*^9}, {
   3.9376573951299953`*^9, 3.9376574529761486`*^9}, {3.9376574879749317`*^9, 
   3.937657506795227*^9}, {3.937657685805044*^9, 3.937657710149948*^9}, {
   3.937658879765518*^9, 3.937658960186018*^9}, {3.9376589973941193`*^9, 
   3.937659112643835*^9}, {3.937659154887083*^9, 3.937659228953888*^9}, {
   3.937659260009138*^9, 3.9376592611927414`*^9}, {3.937659315329296*^9, 
   3.937659371712679*^9}, {3.937659509775406*^9, 3.937659510423092*^9}, {
   3.937659553141968*^9, 3.9376595751577244`*^9}, {3.937659634766691*^9, 
   3.937659640409479*^9}, {3.9376596827090855`*^9, 3.937659722403181*^9}, {
   3.937659804559059*^9, 3.9376599282209816`*^9}, {3.9376599595802937`*^9, 
   3.9376600125880604`*^9}, {3.937660071283558*^9, 3.9376600766696644`*^9}, {
   3.9376601368856316`*^9, 3.9376601776762867`*^9}, {3.9376602339770985`*^9, 
   3.9376602439550343`*^9}, {3.93766047757798*^9, 3.937660483298315*^9}, {
   3.9376665349950047`*^9, 3.937666536944111*^9}, {3.937666568767618*^9, 
   3.937666604213175*^9}, {3.937666933178961*^9, 3.9376669333647804`*^9}, {
   3.937667081846863*^9, 3.937667082583967*^9}, {3.937673085853033*^9, 
   3.9376730891173477`*^9}, {3.937718200492319*^9, 3.937718398019949*^9}, {
   3.9377186411000824`*^9, 3.9377186471098824`*^9}, {3.9377186978806477`*^9, 
   3.9377187293472157`*^9}, {3.937718900482353*^9, 3.9377189830227413`*^9}, 
   3.937719049384552*^9, {3.937721463076971*^9, 3.937721629034067*^9}, {
   3.937723201163719*^9, 3.9377232227450695`*^9}, {3.9377240305142117`*^9, 
   3.9377240344544144`*^9}, {3.937724119834385*^9, 3.937724146216673*^9}, {
   3.9377242695593987`*^9, 3.9377243019471874`*^9}, {3.9378249169199314`*^9, 
   3.937824918524002*^9}, {3.978862649424404*^9, 3.978862651024479*^9}, {
   3.9788638469757385`*^9, 3.978863886880396*^9}, {3.9788645916794147`*^9, 
   3.9788645930397816`*^9}},
 Background->RGBColor[
  0.88, 1, 0.88],ExpressionUUID->"c9f1cd11-e543-0a44-977a-d54b88ebe554"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"s", "=", 
   RowBox[{"1", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"n", "=", "51"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"steps", "=", "150"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"spinini", "=", 
    RowBox[{"SparseArray", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"{", "1", "}"}], "->", 
         RowBox[{"1", "/", 
          SqrtBox["2"]}]}], ",", 
        RowBox[{
         RowBox[{"{", "2", "}"}], "->", 
         RowBox[{"I", "/", 
          SqrtBox["2"]}]}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"2", "s"}], "+", "1"}], "}"}]}], "]"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{"symmetric", " ", "initial", " ", "conditions"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"positionini", "=", 
    RowBox[{"SparseArray", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", "26", "}"}], "->", "1"}], ",", 
      RowBox[{"{", "n", "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"wavefunction", "=", 
    RowBox[{"Flatten", "[", 
     RowBox[{"KroneckerProduct", "[", 
      RowBox[{"spinini", ",", "positionini"}], "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"H", "=", 
   RowBox[{"KroneckerProduct", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"1", "/", 
       SqrtBox["2"]}], 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", 
          RowBox[{"-", "1"}]}], "}"}]}], "}"}]}], ",", 
     RowBox[{"IdentityMatrix", "[", "n", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"shift", "[", "wavefunction_", "]"}], ":=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"RotateLeft", "[", 
      RowBox[{"wavefunction", "[", 
       RowBox[{"[", 
        RowBox[{"1", ";;", "n"}], "]"}], "]"}], "]"}], ",", 
     RowBox[{"RotateRight", "[", 
      RowBox[{"wavefunction", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"n", "+", "1"}], ";;", 
         RowBox[{"2", "n"}]}], "]"}], "]"}], " ", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"coinandshift", "[", "wavefunction_", "]"}], ":=", 
    RowBox[{"shift", "[", 
     RowBox[{"H", ".", "wavefunction"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"wavefunctions", "=", 
   RowBox[{"Transpose", "[", 
    RowBox[{"NestList", "[", 
     RowBox[{"coinandshift", ",", "wavefunction", ",", "steps"}], "]"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"probabilities", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"Abs", "[", 
       RowBox[{"wavefunctions", "[", 
        RowBox[{"[", 
         RowBox[{"1", ";;", "n"}], "]"}], "]"}], "]"}], "^", "2"}], "+", 
     RowBox[{
      RowBox[{"Abs", "[", 
       RowBox[{"wavefunctions", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"n", "+", "1"}], ";;", 
          RowBox[{"2", "n"}]}], "]"}], "]"}], "]"}], "^", "2"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"frames", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"ListPlot", "[", 
       RowBox[{
        RowBox[{"probabilities", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", 
           RowBox[{"1", "+", "i"}]}], "]"}], "]"}], ",", 
        RowBox[{"DataRange", "->", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "25"}], ",", "25"}], "}"}]}], ",", 
        RowBox[{"PlotRange", "->", "Full"}], ",", 
        RowBox[{"Joined", "->", "True"}], ",", 
        RowBox[{"GridLines", "->", "Automatic"}], ",", 
        RowBox[{
        "PlotLabel", "->", 
         "\"\<Animated probability distribution for 1D quantum walk showing \
periodic boundary conditions\>\""}], ",", 
        RowBox[{"Frame", "->", "True"}], ",", 
        RowBox[{"FrameLabel", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\"\<Position\>\"", ",", "\"\<Probability\>\""}], "}"}]}], 
        ",", 
        RowBox[{"ImageSize", "->", "500"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "0", ",", "steps", ",", "1"}], "}"}]}], "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ListAnimate", "[", 
   RowBox[{"frames", ",", 
    RowBox[{"AnimationRunning", "->", "False"}]}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"ListDensityPlot", "[", 
  RowBox[{"probabilities", ",", 
   RowBox[{"DataRange", "->", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "steps"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "25"}], ",", "25"}], "}"}]}], "}"}]}], ",", 
   RowBox[{"PlotRange", "->", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0.15"}], "}"}]}], ",", 
   RowBox[{"AspectRatio", "->", 
    RowBox[{"n", "/", "steps"}]}], ",", 
   RowBox[{"InterpolationOrder", "\[Rule]", "0"}], ",", 
   RowBox[{
   "PlotLabel", "->", 
    "\"\<Probability distribution for 1D quantum walk showing periodic \
boundary conditions\>\""}], ",", 
   RowBox[{"PlotLegends", "\[Rule]", "Automatic"}], ",", 
   RowBox[{"Frame", "->", "True"}], ",", 
   RowBox[{"FrameLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<Step\>\"", ",", "\"\<Position\>\""}], "}"}]}], ",", 
   RowBox[{"ImageSize", "->", "600"}]}], 
  "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.937666823943924*^9, 3.9376668254592896`*^9}, {
   3.9376671200328445`*^9, 3.937667120807745*^9}, 3.9377209179298553`*^9, {
   3.9377216368134727`*^9, 3.9377216631137943`*^9}, {3.937723244147417*^9, 
   3.937723289589302*^9}, {3.9377233441612396`*^9, 3.937723397400606*^9}, 
   3.9377240054429817`*^9, {3.9377241482355843`*^9, 3.937724166612606*^9}, 
   3.937724222558777*^9, {3.937728309263647*^9, 3.9377283118514767`*^9}, 
   3.9378238790452805`*^9, {3.9379660616795044`*^9, 3.937966062257393*^9}, {
   3.937966968916708*^9, 3.937967032815048*^9}, 3.9788607979979954`*^9, {
   3.9788608710293617`*^9, 3.9788608822846985`*^9}, {3.9788609162221603`*^9, 
   3.9788609180625305`*^9}, {3.9788623060670185`*^9, 3.9788623185782967`*^9}},
 CellLabel->"In[44]:=",ExpressionUUID->"b093cd13-35cf-b94f-849a-30f2aff798a2"],

Cell[BoxData[
 RowBox[{"Export", "[", 
  RowBox[{
  "\"\<C:\\\\Users\\\\enriq\\\\OneDrive\\\\MSc\\\\1. Programming in \
Mathematica and Python (PMP)\\\\FinalProject\\\\GitHub sharing\\\\.png\>\"", 
   ",", "%619", ",", "\"\<PNG\>\""}], "]"}]], "Input",
 NumberMarks->False,
 CellLabel->"In[59]:=",ExpressionUUID->"e96da1bd-92ac-0440-a09e-603aa045fe94"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Simulation 5: Different coins", "Chapter",
 CellChangeTimes->{{3.937718652475172*^9, 3.93771866424946*^9}, 
   3.937718758111515*^9, 3.937718793419386*^9, {3.9377188428774986`*^9, 
   3.9377188589349155`*^9}, {3.937719057825468*^9, 3.93771905930081*^9}, {
   3.9377246546808643`*^9, 3.9377246558203144`*^9}, {3.9377248643358746`*^9, 
   3.937724895246643*^9}, {3.9377250579822216`*^9, 3.937725066749075*^9}, {
   3.937727142850649*^9, 
   3.9377271436380043`*^9}},ExpressionUUID->"ee2e5e0e-a16b-7c4e-a2fd-\
2036a7334fa3"],

Cell[TextData[{
 "So far, we have studied the walk using the Hadamard coin. Here we \
illustrate how the choice of coin [1] affects the dynamics by comparing two \
additional coins: the identity coin (no mixing, yielding a trivial quantum \
walk) and the Pauli-X coin (bit-flip). We use a lattice with ",
 Cell[BoxData[
  FormBox[
   RowBox[{"n", "=", "201"}], TraditionalForm]],ExpressionUUID->
  "860b6267-ec08-9d41-875d-5af4101e9306"],
 " sites, run 100 steps, and use the symmetric initial coin state, then plot \
the resulting probability distributions."
}], "Text",
 CellFrame->{{0, 0}, {0, 0}},
 CellChangeTimes->{{3.9371210554203663`*^9, 3.9371211223537273`*^9}, 
   3.9371212158161144`*^9, 3.9376283187763042`*^9, {3.9376283503186684`*^9, 
   3.937628463043869*^9}, {3.937628589862278*^9, 3.9376287170224648`*^9}, {
   3.9376289750151863`*^9, 3.9376290110332985`*^9}, {3.937629046627548*^9, 
   3.9376292220868435`*^9}, {3.9376292952296486`*^9, 
   3.9376293099044895`*^9}, {3.937629394158041*^9, 3.9376295119787464`*^9}, {
   3.9376297487521687`*^9, 3.937629837919245*^9}, {3.937629912247637*^9, 
   3.937629972841196*^9}, {3.937630088268343*^9, 3.937630117295601*^9}, {
   3.937630162335182*^9, 3.9376303648756294`*^9}, {3.937630425324274*^9, 
   3.937630447904564*^9}, {3.9376310981933765`*^9, 3.9376311356078644`*^9}, {
   3.937631202183607*^9, 3.937631259009451*^9}, {3.937631291364292*^9, 
   3.9376313135821934`*^9}, {3.937631348683321*^9, 3.9376313692178726`*^9}, {
   3.937631407608553*^9, 3.9376314127031097`*^9}, {3.9376315134897423`*^9, 
   3.937631578392145*^9}, {3.9376316101098385`*^9, 3.937631655282322*^9}, {
   3.937631703194359*^9, 3.9376317365512066`*^9}, {3.9376318463940296`*^9, 
   3.9376318473597317`*^9}, {3.9376326194713974`*^9, 3.9376326628643*^9}, {
   3.937632742923023*^9, 3.9376328437132893`*^9}, {3.9376329233939114`*^9, 
   3.9376329994053288`*^9}, {3.9376330342424107`*^9, 3.937633060236559*^9}, {
   3.9376342046593895`*^9, 3.937634208012888*^9}, {3.937634243899828*^9, 
   3.93763424655826*^9}, {3.9376359788286457`*^9, 3.937635987173435*^9}, {
   3.9376360353926105`*^9, 3.937636122034252*^9}, {3.937636162859995*^9, 
   3.9376361796847973`*^9}, {3.9376362319433765`*^9, 
   3.9376362351220837`*^9}, {3.937636347463188*^9, 3.9376363519557877`*^9}, {
   3.9376366316827545`*^9, 3.937636748521101*^9}, {3.937636831723427*^9, 
   3.93763688677104*^9}, {3.937637031545891*^9, 3.9376370780055866`*^9}, {
   3.937637113929199*^9, 3.937637220422846*^9}, {3.9376372551130886`*^9, 
   3.937637308244028*^9}, {3.9376373476573467`*^9, 3.937637406535515*^9}, {
   3.9376374558463383`*^9, 3.937637547589367*^9}, {3.9376375784290524`*^9, 
   3.9376376458414993`*^9}, {3.9376376926816807`*^9, 
   3.9376377427232285`*^9}, {3.937637815269718*^9, 3.937638006644993*^9}, 
   3.937638131539238*^9, {3.9376382526047764`*^9, 3.9376383778615856`*^9}, {
   3.937638427631836*^9, 3.9376384457953606`*^9}, {3.9376384991287155`*^9, 
   3.937638556890009*^9}, {3.9376386785612183`*^9, 3.9376386807061844`*^9}, 
   3.937638718801607*^9, {3.937638756456089*^9, 3.937638805246828*^9}, {
   3.937639135678833*^9, 3.937639146248209*^9}, {3.9376392044773464`*^9, 
   3.9376392183913345`*^9}, {3.937639265823965*^9, 3.937639268936657*^9}, {
   3.937639307574539*^9, 3.937639383049654*^9}, 3.9376396634813385`*^9, {
   3.937640275495823*^9, 3.9376402800294647`*^9}, {3.937640481635622*^9, 
   3.9376404878876286`*^9}, {3.9376405201948166`*^9, 3.937640579828453*^9}, {
   3.9376406740112686`*^9, 3.937640697118286*^9}, {3.9376411569801083`*^9, 
   3.937641168825096*^9}, {3.9376412862195263`*^9, 3.937641376228302*^9}, 
   3.9376416844560757`*^9, 3.937641725270973*^9, {3.9376418272762775`*^9, 
   3.937641838503166*^9}, {3.937642051754429*^9, 3.9376420983479176`*^9}, 
   3.9376461052260036`*^9, {3.937649464136503*^9, 3.937649655653105*^9}, {
   3.9376496918131638`*^9, 3.937649903471182*^9}, {3.937649988547306*^9, 
   3.937650195922489*^9}, {3.9376502687999115`*^9, 3.9376503394171677`*^9}, {
   3.9376503914331665`*^9, 3.9376504244380608`*^9}, {3.9376504545612965`*^9, 
   3.9376505026856194`*^9}, {3.9376505511455326`*^9, 3.937650723070215*^9}, {
   3.9376508550984707`*^9, 3.937650863163862*^9}, {3.9376509203334656`*^9, 
   3.937650945087673*^9}, {3.93765104551042*^9, 3.9376511829815216`*^9}, {
   3.937651427126198*^9, 3.9376515772553864`*^9}, {3.9376516270518246`*^9, 
   3.9376516462229214`*^9}, 3.937651708853506*^9, {3.937651933314291*^9, 
   3.9376519973766823`*^9}, {3.9376520386997585`*^9, 3.937652078166788*^9}, {
   3.9376521149482765`*^9, 3.9376521737930584`*^9}, {3.937652247555382*^9, 
   3.937652272011904*^9}, {3.937652573305933*^9, 3.937652651598303*^9}, {
   3.937652710705511*^9, 3.937652719594286*^9}, {3.937652751537121*^9, 
   3.937652889792959*^9}, {3.937653424964319*^9, 3.937653440387474*^9}, {
   3.937653486630764*^9, 3.9376535219991455`*^9}, {3.9376537667703705`*^9, 
   3.9376537712246876`*^9}, {3.9376540126467857`*^9, 3.937654060140789*^9}, {
   3.937654127664316*^9, 3.937654209058943*^9}, {3.937654325815996*^9, 
   3.937654343851843*^9}, {3.937654431782078*^9, 3.9376544320266876`*^9}, {
   3.9376544649461403`*^9, 3.9376548808085117`*^9}, {3.9376549252184067`*^9, 
   3.9376549707353115`*^9}, {3.9376550093697586`*^9, 3.9376550287134*^9}, {
   3.937655240866829*^9, 3.9376552837707577`*^9}, {3.937655350320101*^9, 
   3.9376554619829845`*^9}, {3.9376555463594112`*^9, 3.93765557166185*^9}, {
   3.9376557816231804`*^9, 3.9376558587066593`*^9}, {3.9376559031095695`*^9, 
   3.937656009151085*^9}, {3.937656040345949*^9, 3.9376560744786167`*^9}, {
   3.937656108794525*^9, 3.937656303086073*^9}, {3.9376563545804825`*^9, 
   3.9376563910538673`*^9}, {3.937656438858263*^9, 3.93765648134387*^9}, {
   3.937656512473156*^9, 3.9376565660443363`*^9}, {3.937656680393984*^9, 
   3.9376567840551167`*^9}, {3.9376569111185017`*^9, 3.937656938609873*^9}, {
   3.9376569970376835`*^9, 3.9376570957105865`*^9}, {3.937657190793457*^9, 
   3.93765727117675*^9}, {3.937657340583193*^9, 3.9376573611231537`*^9}, {
   3.9376573951299953`*^9, 3.9376574529761486`*^9}, {3.9376574879749317`*^9, 
   3.937657506795227*^9}, {3.937657685805044*^9, 3.937657710149948*^9}, {
   3.937658879765518*^9, 3.937658960186018*^9}, {3.9376589973941193`*^9, 
   3.937659112643835*^9}, {3.937659154887083*^9, 3.937659228953888*^9}, {
   3.937659260009138*^9, 3.9376592611927414`*^9}, {3.937659315329296*^9, 
   3.937659371712679*^9}, {3.937659509775406*^9, 3.937659510423092*^9}, {
   3.937659553141968*^9, 3.9376595751577244`*^9}, {3.937659634766691*^9, 
   3.937659640409479*^9}, {3.9376596827090855`*^9, 3.937659722403181*^9}, {
   3.937659804559059*^9, 3.9376599282209816`*^9}, {3.9376599595802937`*^9, 
   3.9376600125880604`*^9}, {3.937660071283558*^9, 3.9376600766696644`*^9}, {
   3.9376601368856316`*^9, 3.9376601776762867`*^9}, {3.9376602339770985`*^9, 
   3.9376602439550343`*^9}, {3.93766047757798*^9, 3.937660483298315*^9}, {
   3.9376665349950047`*^9, 3.937666536944111*^9}, {3.937666568767618*^9, 
   3.937666604213175*^9}, {3.937666933178961*^9, 3.9376669333647804`*^9}, {
   3.937667081846863*^9, 3.937667082583967*^9}, {3.937673085853033*^9, 
   3.9376730891173477`*^9}, {3.937718200492319*^9, 3.937718398019949*^9}, {
   3.9377186411000824`*^9, 3.9377186471098824`*^9}, {3.9377186978806477`*^9, 
   3.9377187293472157`*^9}, {3.937718900482353*^9, 3.9377189830227413`*^9}, 
   3.9377190608519897`*^9, {3.9377246746494427`*^9, 3.93772467656822*^9}, 
   3.93772486942165*^9, {3.937725068237362*^9, 3.9377252860043144`*^9}, {
   3.9377257926299667`*^9, 3.937725821745487*^9}, {3.937726743681486*^9, 
   3.937726754584017*^9}, {3.9377269240236034`*^9, 3.9377269843064747`*^9}, {
   3.93772705937871*^9, 3.9377270600402203`*^9}, {3.937727126285473*^9, 
   3.9377271406420555`*^9}, {3.9377283292634964`*^9, 
   3.9377283430010815`*^9}, {3.9377285035277367`*^9, 
   3.9377285420778427`*^9}, {3.9378202954314175`*^9, 3.937820295960026*^9}, {
   3.978863906844019*^9, 3.9788639146424007`*^9}, {3.9788639688972225`*^9, 
   3.978863985473543*^9}, {3.97886465304957*^9, 3.9788646549288445`*^9}},
 Background->RGBColor[
  0.88, 1, 0.88],ExpressionUUID->"f4ffe87d-b2db-a740-a507-d6ceb52c54d8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"s", "=", 
   RowBox[{"1", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"n", "=", "201"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"steps", "=", "100"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"spinini", "=", 
    RowBox[{"SparseArray", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"{", "1", "}"}], "->", 
         RowBox[{"1", "/", 
          SqrtBox["2"]}]}], ",", 
        RowBox[{
         RowBox[{"{", "2", "}"}], "->", 
         RowBox[{"I", "/", 
          SqrtBox["2"]}]}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"2", "s"}], "+", "1"}], "}"}]}], "]"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{"symmetric", " ", "initial", " ", "conditions"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"positionini", "=", 
    RowBox[{"SparseArray", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", "101", "}"}], "->", "1"}], ",", 
      RowBox[{"{", "n", "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"wavefunction", "=", 
    RowBox[{"Flatten", "[", 
     RowBox[{"KroneckerProduct", "[", 
      RowBox[{"spinini", ",", "positionini"}], "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Id", "=", 
    RowBox[{"IdentityMatrix", "[", 
     RowBox[{"2", "*", "n"}], "]"}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"Identity", " ", "coin"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"X", "=", 
    RowBox[{"KroneckerProduct", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "0"}], "}"}]}], "}"}], ",", 
      RowBox[{"IdentityMatrix", "[", "n", "]"}]}], "]"}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"Pauli", "-", 
    RowBox[{"X", " ", "coin"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"shift", "[", "wavefunction_", "]"}], ":=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"RotateLeft", "[", 
      RowBox[{"wavefunction", "[", 
       RowBox[{"[", 
        RowBox[{"1", ";;", "n"}], "]"}], "]"}], "]"}], ",", 
     RowBox[{"RotateRight", "[", 
      RowBox[{"wavefunction", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"n", "+", "1"}], ";;", 
         RowBox[{"2", "n"}]}], "]"}], "]"}], " ", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"coinandshiftId", "[", "wavefunction_", "]"}], ":=", 
   RowBox[{"shift", "[", 
    RowBox[{"Id", ".", "wavefunction"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"coinandshiftX", "[", "wavefunction_", "]"}], ":=", 
    RowBox[{"shift", "[", 
     RowBox[{"X", ".", "wavefunction"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"wavefunctionsId", "=", 
   RowBox[{"Transpose", "[", 
    RowBox[{"NestList", "[", 
     RowBox[{"coinandshiftId", ",", "wavefunction", ",", "steps"}], "]"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"probabilitiesId", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Abs", "[", 
      RowBox[{"wavefunctionsId", "[", 
       RowBox[{"[", 
        RowBox[{"1", ";;", "n"}], "]"}], "]"}], "]"}], "^", "2"}], "+", 
    RowBox[{
     RowBox[{"Abs", "[", 
      RowBox[{"wavefunctionsId", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"n", "+", "1"}], ";;", 
         RowBox[{"2", "n"}]}], "]"}], "]"}], "]"}], "^", "2"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"wavefunctionsX", "=", 
   RowBox[{"Transpose", "[", 
    RowBox[{"NestList", "[", 
     RowBox[{"coinandshiftX", ",", "wavefunction", ",", "steps"}], "]"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"probabilitiesX", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"Abs", "[", 
       RowBox[{"wavefunctionsX", "[", 
        RowBox[{"[", 
         RowBox[{"1", ";;", "n"}], "]"}], "]"}], "]"}], "^", "2"}], "+", 
     RowBox[{
      RowBox[{"Abs", "[", 
       RowBox[{"wavefunctionsX", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"n", "+", "1"}], ";;", 
          RowBox[{"2", "n"}]}], "]"}], "]"}], "]"}], "^", "2"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"ListDensityPlot", "[", 
  RowBox[{
   RowBox[{"Transpose", "[", "probabilitiesId", "]"}], ",", 
   RowBox[{"DataRange", "->", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "100"}], ",", "100"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "steps"}], "}"}]}], "}"}]}], ",", 
   RowBox[{"PlotRange", "->", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0.15"}], "}"}]}], ",", 
   RowBox[{"AspectRatio", "->", 
    RowBox[{"steps", "/", "n"}]}], ",", 
   RowBox[{"InterpolationOrder", "\[Rule]", "0"}], ",", 
   RowBox[{
   "PlotLabel", "->", 
    "\"\<Probability distribution for 1D quantum walk using the identity coin\
\>\""}], ",", 
   RowBox[{"PlotLegends", "\[Rule]", "Automatic"}], ",", 
   RowBox[{"Frame", "->", "True"}], ",", 
   RowBox[{"FrameLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<Position\>\"", ",", "\"\<Step\>\""}], "}"}]}], ",", 
   RowBox[{"ImageSize", "->", "500"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"ListDensityPlot", "[", 
  RowBox[{
   RowBox[{"Transpose", "[", "probabilitiesX", "]"}], ",", 
   RowBox[{"DataRange", "->", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "100"}], ",", "100"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "steps"}], "}"}]}], "}"}]}], ",", 
   RowBox[{"PlotRange", "->", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0.15"}], "}"}]}], ",", 
   RowBox[{"AspectRatio", "->", 
    RowBox[{"steps", "/", "n"}]}], ",", 
   RowBox[{"InterpolationOrder", "\[Rule]", "0"}], ",", 
   RowBox[{
   "PlotLabel", "->", 
    "\"\<Probability distribution for 1D quantum walk using the Pauli-X \
coin\>\""}], ",", 
   RowBox[{"PlotLegends", "\[Rule]", "Automatic"}], ",", 
   RowBox[{"Frame", "->", "True"}], ",", 
   RowBox[{"FrameLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<Position\>\"", ",", "\"\<Step\>\""}], "}"}]}], ",", 
   RowBox[{"ImageSize", "->", "500"}]}], 
  "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.937666823943924*^9, 3.9376668254592896`*^9}, 
   3.937666958022026*^9, {3.937667124455971*^9, 3.937667125018675*^9}, {
   3.9377252949579105`*^9, 3.9377254457384453`*^9}, 3.937726994829935*^9, {
   3.937727120225712*^9, 3.937727122401249*^9}, {3.937727168910038*^9, 
   3.937727192559492*^9}, {3.9377273376246376`*^9, 3.93772749534058*^9}, {
   3.9377275310140285`*^9, 3.9377277209320946`*^9}, 3.9377278052664223`*^9, {
   3.937727876124378*^9, 3.9377278776863155`*^9}, {3.9377279526844406`*^9, 
   3.9377279541987476`*^9}, {3.937728357925949*^9, 3.937728363508623*^9}, 
   3.937728488433941*^9, {3.9377285483265533`*^9, 3.937728621324667*^9}, {
   3.937728654830042*^9, 3.937728759745308*^9}, {3.9377287946612797`*^9, 
   3.937728824252098*^9}, {3.937823874986519*^9, 3.937823876143858*^9}, {
   3.9379670751107445`*^9, 3.9379671108933163`*^9}, {3.937967375977564*^9, 
   3.9379673762755337`*^9}, 3.978862344357847*^9},
 CellLabel->"In[60]:=",ExpressionUUID->"8aa646af-7079-4144-9dce-28bbf489e14e"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Simulation 6: 1D quantum walk for a spin 1 walker", "Chapter",
 CellChangeTimes->{{3.937718652475172*^9, 3.93771866424946*^9}, 
   3.937718758111515*^9, 3.937718793419386*^9, {3.9377188428774986`*^9, 
   3.9377188589349155`*^9}, {3.937719057825468*^9, 3.93771905930081*^9}, {
   3.9377246546808643`*^9, 3.9377246558203144`*^9}, {3.9377248643358746`*^9, 
   3.937724895246643*^9}, {3.9377250579822216`*^9, 3.937725066749075*^9}, {
   3.9377269980682926`*^9, 3.937726999418253*^9}, {3.9378229061269455`*^9, 
   3.93782291529154*^9}, {3.9378233960261345`*^9, 
   3.937823396586666*^9}},ExpressionUUID->"f5ec9316-6519-ce41-b062-\
8f2413eb187d"],

Cell[TextData[{
 "We simulate a spin-1 (three-level) quantum walk. In this case, since the \
spin is a superposition of three states, we need a coin defined by a ",
 Cell[BoxData[
  FormBox[
   RowBox[{"3", "x3"}], TraditionalForm]],ExpressionUUID->
  "662aa362-338f-0f4b-ba38-e5171f168671"],
 " unitary matrix. One commonly used is the Grover coin, which is defined for \
any dimension [2, 3]. We also need to redefine the shifting operation: now, \
when the spin of the walker is",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"|", 
     RowBox[{"-", "1"}]}], "\[RightAngleBracket]"}], TraditionalForm]],
  ExpressionUUID->"be6b4b75-409c-3a4d-9c20-469b4b17310d"],
 " or ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"|", "1"}], "\[RightAngleBracket]"}], TraditionalForm]],
  ExpressionUUID->"2d5c2e27-9692-2c4d-ba64-2a97ac0004a9"],
 ", the walker will turn left or right, respectively\.08; in the other case, \
if the spin is ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"|", "0"}], "\[RightAngleBracket]"}], TraditionalForm]],
  ExpressionUUID->"de49401c-50c8-a54a-80b4-0205c600dcdc"],
 ", it will remain in its position. We simulate a lattice with ",
 Cell[BoxData[
  FormBox[
   RowBox[{"n", "=", "201"}], TraditionalForm]],ExpressionUUID->
  "233af5c7-0c2a-5641-9b88-5c519384e806"],
 " points for 100 steps."
}], "Text",
 CellFrame->{{0, 0}, {0, 0}},
 InitializationCell->True,
 CellChangeTimes->{{3.9371210554203663`*^9, 3.9371211223537273`*^9}, 
   3.9371212158161144`*^9, 3.9376283187763042`*^9, {3.9376283503186684`*^9, 
   3.937628463043869*^9}, {3.937628589862278*^9, 3.9376287170224648`*^9}, {
   3.9376289750151863`*^9, 3.9376290110332985`*^9}, {3.937629046627548*^9, 
   3.9376292220868435`*^9}, {3.9376292952296486`*^9, 
   3.9376293099044895`*^9}, {3.937629394158041*^9, 3.9376295119787464`*^9}, {
   3.9376297487521687`*^9, 3.937629837919245*^9}, {3.937629912247637*^9, 
   3.937629972841196*^9}, {3.937630088268343*^9, 3.937630117295601*^9}, {
   3.937630162335182*^9, 3.9376303648756294`*^9}, {3.937630425324274*^9, 
   3.937630447904564*^9}, {3.9376310981933765`*^9, 3.9376311356078644`*^9}, {
   3.937631202183607*^9, 3.937631259009451*^9}, {3.937631291364292*^9, 
   3.9376313135821934`*^9}, {3.937631348683321*^9, 3.9376313692178726`*^9}, {
   3.937631407608553*^9, 3.9376314127031097`*^9}, {3.9376315134897423`*^9, 
   3.937631578392145*^9}, {3.9376316101098385`*^9, 3.937631655282322*^9}, {
   3.937631703194359*^9, 3.9376317365512066`*^9}, {3.9376318463940296`*^9, 
   3.9376318473597317`*^9}, {3.9376326194713974`*^9, 3.9376326628643*^9}, {
   3.937632742923023*^9, 3.9376328437132893`*^9}, {3.9376329233939114`*^9, 
   3.9376329994053288`*^9}, {3.9376330342424107`*^9, 3.937633060236559*^9}, {
   3.9376342046593895`*^9, 3.937634208012888*^9}, {3.937634243899828*^9, 
   3.93763424655826*^9}, {3.9376359788286457`*^9, 3.937635987173435*^9}, {
   3.9376360353926105`*^9, 3.937636122034252*^9}, {3.937636162859995*^9, 
   3.9376361796847973`*^9}, {3.9376362319433765`*^9, 
   3.9376362351220837`*^9}, {3.937636347463188*^9, 3.9376363519557877`*^9}, {
   3.9376366316827545`*^9, 3.937636748521101*^9}, {3.937636831723427*^9, 
   3.93763688677104*^9}, {3.937637031545891*^9, 3.9376370780055866`*^9}, {
   3.937637113929199*^9, 3.937637220422846*^9}, {3.9376372551130886`*^9, 
   3.937637308244028*^9}, {3.9376373476573467`*^9, 3.937637406535515*^9}, {
   3.9376374558463383`*^9, 3.937637547589367*^9}, {3.9376375784290524`*^9, 
   3.9376376458414993`*^9}, {3.9376376926816807`*^9, 
   3.9376377427232285`*^9}, {3.937637815269718*^9, 3.937638006644993*^9}, 
   3.937638131539238*^9, {3.9376382526047764`*^9, 3.9376383778615856`*^9}, {
   3.937638427631836*^9, 3.9376384457953606`*^9}, {3.9376384991287155`*^9, 
   3.937638556890009*^9}, {3.9376386785612183`*^9, 3.9376386807061844`*^9}, 
   3.937638718801607*^9, {3.937638756456089*^9, 3.937638805246828*^9}, {
   3.937639135678833*^9, 3.937639146248209*^9}, {3.9376392044773464`*^9, 
   3.9376392183913345`*^9}, {3.937639265823965*^9, 3.937639268936657*^9}, {
   3.937639307574539*^9, 3.937639383049654*^9}, 3.9376396634813385`*^9, {
   3.937640275495823*^9, 3.9376402800294647`*^9}, {3.937640481635622*^9, 
   3.9376404878876286`*^9}, {3.9376405201948166`*^9, 3.937640579828453*^9}, {
   3.9376406740112686`*^9, 3.937640697118286*^9}, {3.9376411569801083`*^9, 
   3.937641168825096*^9}, {3.9376412862195263`*^9, 3.937641376228302*^9}, 
   3.9376416844560757`*^9, 3.937641725270973*^9, {3.9376418272762775`*^9, 
   3.937641838503166*^9}, {3.937642051754429*^9, 3.9376420983479176`*^9}, 
   3.9376461052260036`*^9, {3.937649464136503*^9, 3.937649655653105*^9}, {
   3.9376496918131638`*^9, 3.937649903471182*^9}, {3.937649988547306*^9, 
   3.937650195922489*^9}, {3.9376502687999115`*^9, 3.9376503394171677`*^9}, {
   3.9376503914331665`*^9, 3.9376504244380608`*^9}, {3.9376504545612965`*^9, 
   3.9376505026856194`*^9}, {3.9376505511455326`*^9, 3.937650723070215*^9}, {
   3.9376508550984707`*^9, 3.937650863163862*^9}, {3.9376509203334656`*^9, 
   3.937650945087673*^9}, {3.93765104551042*^9, 3.9376511829815216`*^9}, {
   3.937651427126198*^9, 3.9376515772553864`*^9}, {3.9376516270518246`*^9, 
   3.9376516462229214`*^9}, 3.937651708853506*^9, {3.937651933314291*^9, 
   3.9376519973766823`*^9}, {3.9376520386997585`*^9, 3.937652078166788*^9}, {
   3.9376521149482765`*^9, 3.9376521737930584`*^9}, {3.937652247555382*^9, 
   3.937652272011904*^9}, {3.937652573305933*^9, 3.937652651598303*^9}, {
   3.937652710705511*^9, 3.937652719594286*^9}, {3.937652751537121*^9, 
   3.937652889792959*^9}, {3.937653424964319*^9, 3.937653440387474*^9}, {
   3.937653486630764*^9, 3.9376535219991455`*^9}, {3.9376537667703705`*^9, 
   3.9376537712246876`*^9}, {3.9376540126467857`*^9, 3.937654060140789*^9}, {
   3.937654127664316*^9, 3.937654209058943*^9}, {3.937654325815996*^9, 
   3.937654343851843*^9}, {3.937654431782078*^9, 3.9376544320266876`*^9}, {
   3.9376544649461403`*^9, 3.9376548808085117`*^9}, {3.9376549252184067`*^9, 
   3.9376549707353115`*^9}, {3.9376550093697586`*^9, 3.9376550287134*^9}, {
   3.937655240866829*^9, 3.9376552837707577`*^9}, {3.937655350320101*^9, 
   3.9376554619829845`*^9}, {3.9376555463594112`*^9, 3.93765557166185*^9}, {
   3.9376557816231804`*^9, 3.9376558587066593`*^9}, {3.9376559031095695`*^9, 
   3.937656009151085*^9}, {3.937656040345949*^9, 3.9376560744786167`*^9}, {
   3.937656108794525*^9, 3.937656303086073*^9}, {3.9376563545804825`*^9, 
   3.9376563910538673`*^9}, {3.937656438858263*^9, 3.93765648134387*^9}, {
   3.937656512473156*^9, 3.9376565660443363`*^9}, {3.937656680393984*^9, 
   3.9376567840551167`*^9}, {3.9376569111185017`*^9, 3.937656938609873*^9}, {
   3.9376569970376835`*^9, 3.9376570957105865`*^9}, {3.937657190793457*^9, 
   3.93765727117675*^9}, {3.937657340583193*^9, 3.9376573611231537`*^9}, {
   3.9376573951299953`*^9, 3.9376574529761486`*^9}, {3.9376574879749317`*^9, 
   3.937657506795227*^9}, {3.937657685805044*^9, 3.937657710149948*^9}, {
   3.937658879765518*^9, 3.937658960186018*^9}, {3.9376589973941193`*^9, 
   3.937659112643835*^9}, {3.937659154887083*^9, 3.937659228953888*^9}, {
   3.937659260009138*^9, 3.9376592611927414`*^9}, {3.937659315329296*^9, 
   3.937659371712679*^9}, {3.937659509775406*^9, 3.937659510423092*^9}, {
   3.937659553141968*^9, 3.9376595751577244`*^9}, {3.937659634766691*^9, 
   3.937659640409479*^9}, {3.9376596827090855`*^9, 3.937659722403181*^9}, {
   3.937659804559059*^9, 3.9376599282209816`*^9}, {3.9376599595802937`*^9, 
   3.9376600125880604`*^9}, {3.937660071283558*^9, 3.9376600766696644`*^9}, {
   3.9376601368856316`*^9, 3.9376601776762867`*^9}, {3.9376602339770985`*^9, 
   3.9376602439550343`*^9}, {3.93766047757798*^9, 3.937660483298315*^9}, {
   3.9376665349950047`*^9, 3.937666536944111*^9}, {3.937666568767618*^9, 
   3.937666604213175*^9}, {3.937666933178961*^9, 3.9376669333647804`*^9}, {
   3.937667081846863*^9, 3.937667082583967*^9}, {3.937673085853033*^9, 
   3.9376730891173477`*^9}, {3.937718200492319*^9, 3.937718398019949*^9}, {
   3.9377186411000824`*^9, 3.9377186471098824`*^9}, {3.9377186978806477`*^9, 
   3.9377187293472157`*^9}, {3.937718900482353*^9, 3.9377189830227413`*^9}, 
   3.9377190608519897`*^9, {3.9377246746494427`*^9, 3.93772467656822*^9}, 
   3.93772486942165*^9, {3.937725068237362*^9, 3.9377252860043144`*^9}, {
   3.9377257926299667`*^9, 3.937725821745487*^9}, {3.937726743681486*^9, 
   3.937726754584017*^9}, {3.9377269240236034`*^9, 3.9377270543450947`*^9}, 
   3.937729030765295*^9, {3.9377291074984474`*^9, 3.93772911844009*^9}, {
   3.937732159174446*^9, 3.9377321822115097`*^9}, {3.9378229373539715`*^9, 
   3.9378231532471485`*^9}, {3.9378234061906357`*^9, 
   3.9378235083011017`*^9}, {3.937823629864252*^9, 3.937823666703621*^9}, {
   3.937823907785696*^9, 3.9378239309609985`*^9}, {3.978863997617691*^9, 
   3.978864077451124*^9}, {3.978864123809767*^9, 3.9788641415909863`*^9}, {
   3.9788646835575714`*^9, 3.978864684215334*^9}},
 Background->RGBColor[
  0.88, 1, 0.88],ExpressionUUID->"9de5085c-dbe1-fb4f-bb3e-0ee698b68cf5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"s", "=", "1"}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{"now", ",", " ", 
    RowBox[{"the", " ", "spin", " ", "is", " ", "1"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"n", "=", "201"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"steps", "=", "100"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"spinini", "=", 
    RowBox[{"SparseArray", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", "2", "}"}], "->", "1"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"2", "s"}], "+", "1"}], "}"}]}], "]"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{"initially", ",", " ", 
    RowBox[{
     RowBox[{"the", " ", "particle", " ", "has", " ", "spin"}], " ", "|", 
     RowBox[{"0", ">"}]}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"positionini", "=", 
    RowBox[{"SparseArray", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", "101", "}"}], "->", "1"}], ",", 
      RowBox[{"{", "n", "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"wavefunction", "=", 
    RowBox[{"Flatten", "[", 
     RowBox[{"KroneckerProduct", "[", 
      RowBox[{"spinini", ",", "positionini"}], "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"G3aux", "=", 
    RowBox[{
     RowBox[{"1", "/", "3"}], 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "2", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", 
         RowBox[{"-", "1"}], ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "2", ",", 
         RowBox[{"-", "1"}]}], "}"}]}], "}"}]}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
   "Grover", " ", "coin", " ", "in", " ", "three", " ", "dimensions"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"G3", "=", 
   RowBox[{"KroneckerProduct", "[", 
    RowBox[{"G3aux", " ", ",", 
     RowBox[{"IdentityMatrix", "[", "n", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"shift", "[", "wavefunction_", "]"}], ":=", 
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"RotateLeft", "[", 
       RowBox[{"wavefunction", "[", 
        RowBox[{"[", 
         RowBox[{"1", ";;", "n"}], "]"}], "]"}], "]"}], ",", 
      RowBox[{"wavefunction", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"n", "+", "1"}], ";;", 
         RowBox[{"2", "n"}]}], "]"}], "]"}], ",", 
      RowBox[{"RotateRight", "[", 
       RowBox[{"wavefunction", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{
           RowBox[{"2", "n"}], "+", "1"}], ";;", 
          RowBox[{"3", "n"}]}], "]"}], "]"}], "]"}]}], "]"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{"new", " ", "shift", " ", "operation"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"coinandshift", "[", "wavefunction_", "]"}], ":=", 
    RowBox[{"shift", "[", 
     RowBox[{"G3", ".", "wavefunction"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"wavefunctions", "=", 
   RowBox[{"Transpose", "[", 
    RowBox[{"NestList", "[", 
     RowBox[{"coinandshift", ",", "wavefunction", ",", "steps"}], "]"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"probabilities", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"Abs", "[", 
       RowBox[{"wavefunctions", "[", 
        RowBox[{"[", 
         RowBox[{"1", ";;", "n"}], "]"}], "]"}], "]"}], "^", "2"}], "+", 
     RowBox[{
      RowBox[{"Abs", "[", 
       RowBox[{"wavefunctions", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"n", "+", "1"}], ";;", 
          RowBox[{"2", "n"}]}], "]"}], "]"}], "]"}], "^", "2"}], "+", 
     RowBox[{
      RowBox[{"Abs", "[", 
       RowBox[{"wavefunctions", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{
           RowBox[{"2", "n"}], "+", "1"}], ";;", 
          RowBox[{"3", "n"}]}], "]"}], "]"}], "]"}], "^", "2"}]}]}], ";"}], 
  RowBox[{"(*", "tweak", "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"frames", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"ListPlot", "[", 
       RowBox[{
        RowBox[{"probabilities", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", 
           RowBox[{"1", "+", "i"}]}], "]"}], "]"}], ",", 
        RowBox[{"DataRange", "->", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "100"}], ",", "100"}], "}"}]}], ",", 
        RowBox[{"PlotRange", "->", "Full"}], ",", 
        RowBox[{"Joined", "->", "True"}], ",", 
        RowBox[{"GridLines", "->", "Automatic"}], ",", 
        RowBox[{
        "PlotLabel", "->", 
         "\"\<Animated probability distribution for 1D quantum walk for a \
spin 1 walker\>\""}], ",", 
        RowBox[{"Frame", "->", "True"}], ",", 
        RowBox[{"FrameLabel", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\"\<Position\>\"", ",", "\"\<Probability\>\""}], "}"}]}], 
        ",", 
        RowBox[{"ImageSize", "->", "500"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "0", ",", "steps", ",", "1"}], "}"}]}], "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ListAnimate", "[", 
   RowBox[{"frames", ",", 
    RowBox[{"AnimationRunning", "->", "False"}]}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"ListDensityPlot", "[", 
  RowBox[{
   RowBox[{"Transpose", "[", "probabilities", "]"}], ",", 
   RowBox[{"DataRange", "->", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "100"}], ",", "100"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "100"}], "}"}]}], "}"}]}], ",", 
   RowBox[{"PlotRange", "->", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0.15"}], "}"}]}], ",", 
   RowBox[{"AspectRatio", "->", 
    RowBox[{"steps", "/", "n"}]}], ",", 
   RowBox[{"InterpolationOrder", "\[Rule]", "0"}], ",", 
   RowBox[{
   "PlotLabel", "->", 
    "\"\<Probability distribution for 1D quantum walk at several steps for a \
spin 1 walker\>\""}], ",", 
   RowBox[{"PlotLegends", "\[Rule]", "Automatic"}], ",", 
   RowBox[{"Frame", "->", "True"}], ",", 
   RowBox[{"FrameLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<Position\>\"", ",", "\"\<Step\>\""}], "}"}]}], ",", 
   RowBox[{"ImageSize", "->", "600"}]}], 
  "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.937729042576212*^9, 3.937729048182068*^9}, 
   3.937729090073078*^9, {3.93772913818318*^9, 3.937729225560871*^9}, {
   3.9378227729501133`*^9, 3.937822773764824*^9}, {3.937823515129135*^9, 
   3.937823608043888*^9}, {3.937823675135107*^9, 3.937823752469795*^9}, {
   3.9378237892956085`*^9, 3.937823808962061*^9}, 3.93782386418985*^9, {
   3.9378239674385223`*^9, 3.937824004276079*^9}, {3.937824109367504*^9, 
   3.9378241240080376`*^9}, 3.937824215794956*^9, {3.9378245928449764`*^9, 
   3.9378245955185394`*^9}, 3.9378246682320232`*^9, 3.937824699154072*^9, {
   3.937825048016657*^9, 3.9378250502001495`*^9}, {3.9379671762219048`*^9, 
   3.9379672187209206`*^9}, {3.978862327844137*^9, 3.978862342158785*^9}},
 CellLabel->"In[78]:=",ExpressionUUID->"8f33e15a-1b75-4a45-8f7f-daf6a4f1348a"],

Cell["\<\
References:
[1] J. Kempe, \[OpenCurlyDoubleQuote]Quantum random walks \[Dash] an \
introductory overview,\[CloseCurlyDoubleQuote] Contemporary Physics 44(4), \
307\[Dash]327 (2003). arXiv:quant-ph/0303081. DOI: \
10.1080/00107151031000110776. Available at: \
https://arxiv.org/abs/quant-ph/0303081.
[2] L. K. Grover, \[OpenCurlyDoubleQuote]A fast quantum mechanical algorithm \
for database search,\[CloseCurlyDoubleQuote] in Proceedings of the 28th \
Annual ACM Symposium on Theory of Computing (STOC \[CloseCurlyQuote]96), pp. \
212\[Dash]219 (1996). DOI: 10.1145/237814.237866. Available at: \
https://arxiv.org/abs/quant-ph/9605043.
[3] A. Saha, D. Saha, and A. Chakrabarti, \
\[OpenCurlyDoubleQuote]Discrete-time Quantum Walks in Qudit Systems,\
\[CloseCurlyDoubleQuote] arXiv:2207.04319 (2022). DOI: \
10.48550/arXiv.2207.04319. Available at: https://arxiv.org/abs/2207.04319.\
\>", "Text",
 CellFrame->{{0, 0}, {0, 0}},
 CellChangeTimes->{{3.9371210554203663`*^9, 3.9371211223537273`*^9}, 
   3.9371212158161144`*^9, 3.9376283187763042`*^9, {3.9376283503186684`*^9, 
   3.937628463043869*^9}, {3.937628589862278*^9, 3.9376287170224648`*^9}, {
   3.9376289750151863`*^9, 3.9376290110332985`*^9}, {3.937629046627548*^9, 
   3.9376292220868435`*^9}, {3.9376292952296486`*^9, 
   3.9376293099044895`*^9}, {3.937629394158041*^9, 3.9376295119787464`*^9}, {
   3.9376297487521687`*^9, 3.937629837919245*^9}, {3.937629912247637*^9, 
   3.937629972841196*^9}, {3.937630088268343*^9, 3.937630117295601*^9}, {
   3.937630162335182*^9, 3.9376303648756294`*^9}, {3.937630425324274*^9, 
   3.937630447904564*^9}, {3.9376310981933765`*^9, 3.9376311356078644`*^9}, {
   3.937631202183607*^9, 3.937631259009451*^9}, {3.937631291364292*^9, 
   3.9376313135821934`*^9}, {3.937631348683321*^9, 3.9376313692178726`*^9}, {
   3.937631407608553*^9, 3.9376314127031097`*^9}, {3.9376315134897423`*^9, 
   3.937631578392145*^9}, {3.9376316101098385`*^9, 3.937631655282322*^9}, {
   3.937631703194359*^9, 3.9376317365512066`*^9}, {3.9376318463940296`*^9, 
   3.9376318473597317`*^9}, {3.9376326194713974`*^9, 3.9376326628643*^9}, {
   3.937632742923023*^9, 3.9376328437132893`*^9}, {3.9376329233939114`*^9, 
   3.9376329994053288`*^9}, {3.9376330342424107`*^9, 3.937633060236559*^9}, {
   3.9376342046593895`*^9, 3.937634208012888*^9}, {3.937634243899828*^9, 
   3.93763424655826*^9}, {3.9376359788286457`*^9, 3.937635987173435*^9}, {
   3.9376360353926105`*^9, 3.937636122034252*^9}, {3.937636162859995*^9, 
   3.9376361796847973`*^9}, {3.9376362319433765`*^9, 
   3.9376362351220837`*^9}, {3.937636347463188*^9, 3.9376363519557877`*^9}, {
   3.9376366316827545`*^9, 3.937636748521101*^9}, {3.937636831723427*^9, 
   3.93763688677104*^9}, {3.937637031545891*^9, 3.9376370780055866`*^9}, {
   3.937637113929199*^9, 3.937637220422846*^9}, {3.9376372551130886`*^9, 
   3.937637308244028*^9}, {3.9376373476573467`*^9, 3.937637406535515*^9}, {
   3.9376374558463383`*^9, 3.937637547589367*^9}, {3.9376375784290524`*^9, 
   3.9376376458414993`*^9}, {3.9376376926816807`*^9, 
   3.9376377427232285`*^9}, {3.937637815269718*^9, 3.937638006644993*^9}, 
   3.937638131539238*^9, {3.9376382526047764`*^9, 3.9376383778615856`*^9}, {
   3.937638427631836*^9, 3.9376384457953606`*^9}, {3.9376384991287155`*^9, 
   3.937638556890009*^9}, {3.9376386785612183`*^9, 3.9376386807061844`*^9}, 
   3.937638718801607*^9, {3.937638756456089*^9, 3.937638805246828*^9}, {
   3.937639135678833*^9, 3.937639146248209*^9}, {3.9376392044773464`*^9, 
   3.9376392183913345`*^9}, {3.937639265823965*^9, 3.937639268936657*^9}, {
   3.937639307574539*^9, 3.937639383049654*^9}, 3.9376396634813385`*^9, {
   3.937640275495823*^9, 3.9376402800294647`*^9}, {3.937640481635622*^9, 
   3.9376404878876286`*^9}, {3.9376405201948166`*^9, 3.937640579828453*^9}, {
   3.9376406740112686`*^9, 3.937640697118286*^9}, {3.9376411569801083`*^9, 
   3.937641168825096*^9}, {3.9376412862195263`*^9, 3.937641376228302*^9}, 
   3.9376416844560757`*^9, 3.937641725270973*^9, {3.9376418272762775`*^9, 
   3.937641838503166*^9}, {3.937642051754429*^9, 3.9376420983479176`*^9}, 
   3.9376461052260036`*^9, {3.937649464136503*^9, 3.937649655653105*^9}, {
   3.9376496918131638`*^9, 3.937649903471182*^9}, {3.937649988547306*^9, 
   3.937650195922489*^9}, {3.9376502687999115`*^9, 3.9376503394171677`*^9}, {
   3.9376503914331665`*^9, 3.9376504244380608`*^9}, {3.9376504545612965`*^9, 
   3.9376505026856194`*^9}, {3.9376505511455326`*^9, 3.937650723070215*^9}, {
   3.9376508550984707`*^9, 3.937650863163862*^9}, {3.9376509203334656`*^9, 
   3.937650945087673*^9}, {3.93765104551042*^9, 3.9376511829815216`*^9}, {
   3.937651427126198*^9, 3.9376515772553864`*^9}, {3.9376516270518246`*^9, 
   3.9376516462229214`*^9}, 3.937651708853506*^9, {3.937651933314291*^9, 
   3.9376519973766823`*^9}, {3.9376520386997585`*^9, 3.937652078166788*^9}, {
   3.9376521149482765`*^9, 3.9376521737930584`*^9}, {3.937652247555382*^9, 
   3.937652272011904*^9}, {3.937652573305933*^9, 3.937652651598303*^9}, {
   3.937652710705511*^9, 3.937652719594286*^9}, {3.937652751537121*^9, 
   3.937652889792959*^9}, {3.937653424964319*^9, 3.937653440387474*^9}, {
   3.937653486630764*^9, 3.9376535219991455`*^9}, {3.9376537667703705`*^9, 
   3.9376537712246876`*^9}, {3.9376540126467857`*^9, 3.937654060140789*^9}, {
   3.937654127664316*^9, 3.937654209058943*^9}, {3.937654325815996*^9, 
   3.937654343851843*^9}, {3.937654431782078*^9, 3.9376544320266876`*^9}, {
   3.9376544649461403`*^9, 3.9376548808085117`*^9}, {3.9376549252184067`*^9, 
   3.9376549707353115`*^9}, {3.9376550093697586`*^9, 3.9376550287134*^9}, {
   3.937655240866829*^9, 3.9376552837707577`*^9}, {3.937655350320101*^9, 
   3.9376554619829845`*^9}, {3.9376555463594112`*^9, 3.93765557166185*^9}, {
   3.9376557816231804`*^9, 3.9376558587066593`*^9}, {3.9376559031095695`*^9, 
   3.937656009151085*^9}, {3.937656040345949*^9, 3.9376560744786167`*^9}, {
   3.937656108794525*^9, 3.937656303086073*^9}, {3.9376563545804825`*^9, 
   3.9376563910538673`*^9}, {3.937656438858263*^9, 3.93765648134387*^9}, {
   3.937656512473156*^9, 3.9376565660443363`*^9}, {3.937656680393984*^9, 
   3.9376567840551167`*^9}, {3.9376569111185017`*^9, 3.937656938609873*^9}, {
   3.9376569970376835`*^9, 3.9376570957105865`*^9}, {3.937657190793457*^9, 
   3.93765727117675*^9}, {3.937657340583193*^9, 3.9376573611231537`*^9}, {
   3.9376573951299953`*^9, 3.9376574529761486`*^9}, {3.9376574879749317`*^9, 
   3.937657506795227*^9}, {3.937657685805044*^9, 3.937657710149948*^9}, {
   3.937658879765518*^9, 3.937658960186018*^9}, {3.9376589973941193`*^9, 
   3.937659112643835*^9}, {3.937659154887083*^9, 3.937659228953888*^9}, {
   3.937659260009138*^9, 3.9376592611927414`*^9}, {3.937659315329296*^9, 
   3.937659371712679*^9}, {3.937659509775406*^9, 3.937659510423092*^9}, {
   3.937659553141968*^9, 3.9376595751577244`*^9}, {3.937659634766691*^9, 
   3.937659640409479*^9}, {3.9376596827090855`*^9, 3.937659722403181*^9}, {
   3.937659804559059*^9, 3.9376599282209816`*^9}, {3.9376599595802937`*^9, 
   3.9376600125880604`*^9}, {3.937660071283558*^9, 3.9376600766696644`*^9}, {
   3.9376601368856316`*^9, 3.9376601776762867`*^9}, {3.9376602339770985`*^9, 
   3.9376602439550343`*^9}, {3.93766047757798*^9, 3.937660483298315*^9}, {
   3.9376665349950047`*^9, 3.937666536944111*^9}, {3.937666568767618*^9, 
   3.937666604213175*^9}, {3.937666933178961*^9, 3.9376669333647804`*^9}, {
   3.937667081846863*^9, 3.937667082583967*^9}, {3.937673085853033*^9, 
   3.9376730891173477`*^9}, {3.937718200492319*^9, 3.937718398019949*^9}, {
   3.9377186411000824`*^9, 3.9377186471098824`*^9}, {3.9377186978806477`*^9, 
   3.9377187293472157`*^9}, {3.937718900482353*^9, 3.9377189830227413`*^9}, 
   3.9377190608519897`*^9, {3.9377246746494427`*^9, 3.93772467656822*^9}, 
   3.93772486942165*^9, {3.937725068237362*^9, 3.9377252860043144`*^9}, {
   3.9377257926299667`*^9, 3.937725821745487*^9}, {3.937726743681486*^9, 
   3.937726754584017*^9}, {3.9377269240236034`*^9, 3.9377270511593246`*^9}, {
   3.9378195758290634`*^9, 3.937819584609499*^9}, {3.937819619352852*^9, 
   3.937819653616358*^9}, {3.9378214579022217`*^9, 3.93782146725651*^9}, {
   3.9378224594245834`*^9, 3.9378224653354015`*^9}, {3.9378251221960964`*^9, 
   3.9378251289118423`*^9}, {3.937825210378086*^9, 3.9378252111320133`*^9}, {
   3.978862356745695*^9, 3.978862386758623*^9}, {3.9788640839935646`*^9, 
   3.9788640857433453`*^9}, {3.9788648022337303`*^9, 
   3.9788648048656006`*^9}, {3.978864877677065*^9, 3.978864950836954*^9}, {
   3.9788650349579525`*^9, 3.978865038176399*^9}, {3.978865115675289*^9, 
   3.9788651206315784`*^9}, {3.978865155608349*^9, 3.9788651610969486`*^9}, {
   3.9788652932854843`*^9, 3.978865332262699*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"499cef65-76b4-b940-900b-756f13a835cf"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1141.2, 568.8},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
TaggingRules-><|"TryRealOnly" -> False|>,
FrontEndVersion->"14.1 for Microsoft Windows (64-bit) (July 16, 2024)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"ec651016-9e5b-4a46-9491-2ec32cd9eaa6"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[576, 22, 389, 7, 96, "Title",ExpressionUUID->"5a38b9c0-faae-a047-80bf-5335cb5116f1"],
Cell[968, 31, 954, 14, 28, "Author",ExpressionUUID->"5857c629-264d-b14c-82cf-e2477be330fe"],
Cell[CellGroupData[{
Cell[1947, 49, 320, 6, 67, "Chapter",ExpressionUUID->"a54fa6ab-5893-c543-84d5-b479b6ee5c11"],
Cell[2270, 57, 9035, 147, 115, "Text",ExpressionUUID->"4a15a03f-6504-b642-a1a1-b0fb29c25f50"],
Cell[11308, 206, 8392, 123, 115, "Text",ExpressionUUID->"9726387c-074d-d74c-acf8-8d936d550550"],
Cell[19703, 331, 8174, 204, 451, "Input",ExpressionUUID->"bd7fc86f-edc4-9043-8139-c0c4012eafbb"]
}, Open  ]],
Cell[CellGroupData[{
Cell[27914, 540, 368, 7, 67, "Chapter",ExpressionUUID->"a22ffb84-6732-ee41-a9b0-6469943adb58"],
Cell[28285, 549, 7744, 110, 71, "Text",ExpressionUUID->"c055d4f3-3809-4849-a2fe-7bcabfe65913",
 InitializationCell->True],
Cell[36032, 661, 14438, 288, 546, "Input",ExpressionUUID->"54a247a7-1b0f-9e49-be77-bdcf25323aa4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[50507, 954, 460, 9, 114, "Chapter",ExpressionUUID->"7c9fe1ca-b380-1242-8b13-974094edc5b1"],
Cell[50970, 965, 9054, 148, 93, "Text",ExpressionUUID->"89b146f3-d661-7a42-a272-d9bfa2241069"],
Cell[60027, 1115, 6694, 185, 532, "Input",ExpressionUUID->"1d8fd0da-8a00-e646-9b0d-dc711820f018"]
}, Open  ]],
Cell[CellGroupData[{
Cell[66758, 1305, 439, 6, 67, "Chapter",ExpressionUUID->"6ce1876c-57d6-9148-965e-4374665a3ead"],
Cell[67200, 1313, 7967, 112, 93, "Text",ExpressionUUID->"c9f1cd11-e543-0a44-977a-d54b88ebe554"],
Cell[75170, 1427, 6589, 183, 532, "Input",ExpressionUUID->"b093cd13-35cf-b94f-849a-30f2aff798a2"],
Cell[81762, 1612, 352, 7, 28, "Input",ExpressionUUID->"e96da1bd-92ac-0440-a09e-603aa045fe94"]
}, Open  ]],
Cell[CellGroupData[{
Cell[82151, 1624, 527, 8, 67, "Chapter",ExpressionUUID->"ee2e5e0e-a16b-7c4e-a2fd-2036a7334fa3"],
Cell[82681, 1634, 8214, 115, 93, "Text",ExpressionUUID->"f4ffe87d-b2db-a740-a507-d6ceb52c54d8"],
Cell[90898, 1751, 7601, 212, 546, "Input",ExpressionUUID->"8aa646af-7079-4144-9dce-28bbf489e14e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[98536, 1968, 646, 9, 67, "Chapter",ExpressionUUID->"f5ec9316-6519-ce41-b062-8f2413eb187d"],
Cell[99185, 1979, 9087, 141, 115, "Text",ExpressionUUID->"9de5085c-dbe1-fb4f-bb3e-0ee698b68cf5",
 InitializationCell->True],
Cell[108275, 2122, 7503, 210, 560, "Input",ExpressionUUID->"8f33e15a-1b75-4a45-8f7f-daf6a4f1348a"],
Cell[115781, 2334, 8852, 124, 180, "Text",ExpressionUUID->"499cef65-76b4-b940-900b-756f13a835cf"]
}, Open  ]]
}, Open  ]]
}
]
*)

